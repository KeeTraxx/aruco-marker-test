webpackJsonp([1],{Ltj2:function(t,o){},NHnr:function(t,o,i){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var e=i("7+uW"),r=i("//Fk"),n=i.n(r);function s(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"environment";this.facingMode=o,this.domEl=t}s.prototype.requestWebcamFeed=function(){var t=document.createElement("video");return t.autoplay=!0,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:this.facingMode}}).then(function(o){return console.log("Got stream",o),t.srcObject=o,function(t){return new n.a(function(o,i){t.onloadedmetadata=function(t){o(t)}})}(t)}).then(function(o){return t}).catch(function(t){console.error("Error getting video stream",t)})};var a=s,d={Image:function(t,o,i){this.width=t||0,this.height=o||0,this.data=i||[]},grayscale:function(t,o){for(var i=t.data,e=o.data,r=i.length,n=0,s=0;n<r;n+=4)e[s++]=.299*i[n]+.587*i[n+1]+.114*i[n+2]+.5&255;return o.width=t.width,o.height=t.height,o},threshold:function(t,o,i){var e=t.data,r=o.data,n=e.length,s=[],a=void 0;for(a=0;a<256;++a)s[a]=a<=i?0:255;for(a=0;a<n;++a)r[a]=s[e[a]];return o.width=t.width,o.height=t.height,o},adaptiveThreshold:function(t,o,i,e){var r=t.data,n=o.data,s=r.length,a=[],h=void 0;for(d.stackBoxBlur(t,o,i),h=0;h<768;++h)a[h]=h-255<=-e?255:0;for(h=0;h<s;++h)n[h]=a[r[h]-n[h]+255];return o.width=t.width,o.height=t.height,o},otsu:function(t){var o=t.data,i=o.length,e=[],r=0,n=0,s=0,a=0,d=0,h=0,c=void 0,f=void 0,v=void 0;for(v=0;v<256;++v)e[v]=0;for(v=0;v<i;++v)e[o[v]]++;for(v=0;v<256;++v)n+=e[v]*v;for(v=0;v<256;++v)if(0!==(a+=e[v])){if(0===(d=i-a))break;(f=a*d*(c=(s+=e[v]*v)/a-(n-s)/d)*c)>h&&(h=f,r=v)}return r},stackBoxBlurMult:[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265],stackBoxBlurShift:[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13],BlurStack:function(){this.color=0,this.next=null},stackBoxBlur:function(t,o,i){var e,r=t.data,n=o.data,s=t.height,a=t.width,h=s-1,c=a-1,f=i+i+1,v=i+1,u=d.stackBoxBlurMult[i],l=d.stackBoxBlurShift[i],x=void 0,g=void 0,p=void 0,y=void 0,b=void 0,m=void 0,w=void 0,M=void 0,_=void 0;for(x=e=new d.BlurStack,_=1;_<f;++_)x=x.next=new d.BlurStack;for(x.next=e,y=0,M=0;M<s;++M){for(b=y,p=v*(g=r[y]),x=e,_=0;_<v;++_)x.color=g,x=x.next;for(_=1;_<v;++_)x.color=r[y+_],p+=x.color,x=x.next;for(x=e,w=0;w<a;++w)n[y++]=p*u>>>l,m=b+((m=w+v)<c?m:c),p-=x.color-r[m],x.color=r[m],x=x.next}for(w=0;w<a;++w){for(b=(y=w)+a,p=v*(g=n[y]),x=e,_=0;_<v;++_)x.color=g,x=x.next;for(_=1;_<v;++_)x.color=n[b],p+=x.color,x=x.next,b+=a;for(x=e,M=0;M<s;++M)n[y]=p*u>>>l,m=w+((m=M+v)<h?m:h)*a,p-=x.color-n[m],x.color=n[m],x=x.next,y+=a}return o},gaussianBlur:function(t,o,i,e){var r=d.gaussianKernel(e);return o.width=t.width,o.height=t.height,i.width=t.width,i.height=t.height,d.gaussianBlurFilter(t,i,r,!0),d.gaussianBlurFilter(i,o,r,!1),o},gaussianBlurFilter:function(t,o,i,e){var r=t.data,n=o.data,s=t.height,a=t.width,d=0,h=i.length>>1,c=void 0,f=void 0,v=void 0,u=void 0,l=void 0;for(v=0;v<s;++v)for(u=0;u<a;++u){for(f=0,l=-h;l<=h;++l)e?(c=d+l,u+l<0?c=d:u+l>=a&&(c=d)):(c=d+l*a,v+l<0?c=d:v+l>=s&&(c=d)),f+=i[h+l]*r[c];n[d++]=e?f:f+.5&255}return o},gaussianKernel:function(t){var o=[],i=void 0,e=void 0,r=void 0,n=void 0,s=void 0,a=void 0;if(t<=7&&t%2==1)o=[[1],[.25,.5,.25],[.0625,.25,.375,.25,.0625],[.03125,.109375,.21875,.28125,.21875,.109375,.03125]][t>>1];else{for(r=-.5/((e=.8+.3*((i=.5*(t-1))-1))*e),n=0,a=0;a<t;++a)s=a-i,n+=o[a]=Math.exp(r*s*s);for(n=1/n,a=0;a<t;++a)o[a]*=n}return o},findContours:function(t,o){var i,e,r=t.width,n=t.height,s=[],a=void 0,h=void 0,c=void 0,f=void 0,v=void 0,u=void 0,l=void 0;for(i=d.binaryBorder(t,o),e=d.neighborhoodDeltas(r+2),a=r+3,c=1,u=0;u<n;++u,a+=2)for(l=0;l<r;++l,++a)0!==(h=i[a])&&(f=v=!1,1===h&&0===i[a-1]?f=!0:h>=1&&0===i[a+1]&&(v=!0),(f||v)&&(++c,s.push(d.borderFollowing(i,a,c,{x:l,y:u},v,e))));return s},borderFollowing:function(t,o,i,e,r,n){var s=[],a=void 0,h=void 0,c=void 0,f=void 0,v=void 0;s.hole=r,f=v=r?0:4;do{if(0!==t[a=o+n[f=f-1&7]])break}while(f!==v);if(f===v)t[o]=-i,s.push({x:e.x,y:e.y});else for(h=o;;){v=f;do{c=h+n[++f]}while(0===t[c]);if((f&=7)-1>>>0<v>>>0?t[h]=-i:1===t[h]&&(t[h]=i),s.push({x:e.x,y:e.y}),e.x+=d.neighborhood[f][0],e.y+=d.neighborhood[f][1],c===o&&h===a)break;h=c,f=f+4&7}return s},neighborhood:[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]],neighborhoodDeltas:function(t){for(var o=[],i=d.neighborhood.length,e=0;e<i;++e)o[e]=d.neighborhood[e][0]+d.neighborhood[e][1]*t;return o.concat(o)},approxPolyDP:function(t,o){var i={start_index:0,end_index:0},e={start_index:0,end_index:0},r=[],n=[],s=t.length,a=void 0,d=void 0,h=void 0,c=void 0,f=void 0,v=void 0,u=void 0,l=void 0,x=void 0,g=void 0,p=void 0;for(o*=o,p=0,x=0;x<3;++x)for(f=0,d=t[p=(p+e.start_index)%s],++p===s&&(p=0),g=1;g<s;++g)a=t[p],++p===s&&(p=0),(c=(u=a.x-d.x)*u+(l=a.y-d.y)*l)>f&&(f=c,e.start_index=g);for(f<=o?r.push({x:d.x,y:d.y}):(i.start_index=p,i.end_index=e.start_index+=i.start_index,e.start_index-=e.start_index>=s?s:0,e.end_index=i.start_index,e.end_index<e.start_index&&(e.end_index+=s),n.push({start_index:e.start_index,end_index:e.end_index}),n.push({start_index:i.start_index,end_index:i.end_index}));0!==n.length;){if(h=t[(i=n.pop()).end_index%s],d=t[p=i.start_index%s],++p===s&&(p=0),i.end_index<=i.start_index+1)v=!0;else{for(f=0,u=h.x-d.x,l=h.y-d.y,x=i.start_index+1;x<i.end_index;++x)a=t[p],++p===s&&(p=0),(c=Math.abs((a.y-d.y)*u-(a.x-d.x)*l))>f&&(f=c,e.start_index=x);v=f*f<=o*(u*u+l*l)}v?r.push({x:d.x,y:d.y}):(e.end_index=i.end_index,i.end_index=e.start_index,n.push({start_index:e.start_index,end_index:e.end_index}),n.push({start_index:i.start_index,end_index:i.end_index}))}return r},warp:function(t,o,i,e){var r,n=t.data,s=o.data,a=t.width,h=t.height,c=0,f=void 0,v=void 0,u=void 0,l=void 0,x=void 0,g=void 0,p=void 0,y=void 0,b=void 0,m=void 0,w=void 0,M=void 0,_=void 0,j=void 0,P=void 0,k=void 0,V=void 0,D=void 0,E=void 0,q=void 0,B=void 0;for(M=(r=d.getPerspectiveTransform(i,e-1))[8],_=r[2],j=r[5],q=0;q<e;++q)for(P=M+=r[7],k=_+=r[1],V=j+=r[4],B=0;B<e;++B)P+=r[6],k+=r[0],E=(V+=r[3])/P,v=(f=(D=k/P)>>>0)===a-1?f:f+1,l=1-(u=D-f),p=1-(g=E-(x=E>>>0)),y=b=x*a,m=w=(x===h-1?x:x+1)*a,s[c++]=p*(l*n[y+f]+u*n[b+v])+g*(l*n[m+f]+u*n[w+v])&255;return o.width=e,o.height=e,o},getPerspectiveTransform:function(t,o){var i=d.square2quad(t);return i[0]/=o,i[1]/=o,i[3]/=o,i[4]/=o,i[6]/=o,i[7]/=o,i},square2quad:function(t){var o,i,e=[],r=void 0,n=void 0,s=void 0,a=void 0,d=void 0;return o=t[0].x-t[1].x+t[2].x-t[3].x,i=t[0].y-t[1].y+t[2].y-t[3].y,0===o&&0===i?(e[0]=t[1].x-t[0].x,e[1]=t[2].x-t[1].x,e[2]=t[0].x,e[3]=t[1].y-t[0].y,e[4]=t[2].y-t[1].y,e[5]=t[0].y,e[6]=0,e[7]=0,e[8]=1):(r=t[1].x-t[2].x,n=t[3].x-t[2].x,s=t[1].y-t[2].y,d=r*(a=t[3].y-t[2].y)-n*s,e[6]=(o*a-n*i)/d,e[7]=(r*i-o*s)/d,e[8]=1,e[0]=t[1].x-t[0].x+e[6]*t[1].x,e[1]=t[3].x-t[0].x+e[7]*t[3].x,e[2]=t[0].x,e[3]=t[1].y-t[0].y+e[6]*t[1].y,e[4]=t[3].y-t[0].y+e[7]*t[3].y,e[5]=t[0].y),e},isContourConvex:function(t){var o=0,i=!0,e=t.length,r=0,n=0,s=void 0,a=void 0,d=void 0,h=void 0,c=void 0,f=void 0,v=void 0,u=void 0;for(a=t[e-1],c=(s=t[0]).x-a.x,f=s.y-a.y;r<e;++r){if(++n===e&&(n=0),a=s,v=(s=t[n]).x-a.x,3===(o|=(h=(u=s.y-a.y)*c)>(d=v*f)?1:h<d?2:3)){i=!1;break}c=v,f=u}return i},perimeter:function(t){for(var o=t.length,i=0,e=o-1,r=0,n=void 0,s=void 0;i<o;e=i++)n=t[i].x-t[e].x,s=t[i].y-t[e].y,r+=Math.sqrt(n*n+s*s);return r},minEdgeLength:function(t){for(var o=t.length,i=0,e=o-1,r=1/0,n=void 0,s=void 0,a=void 0;i<o;e=i++)(n=(s=t[i].x-t[e].x)*s+(a=t[i].y-t[e].y)*a)<r&&(r=n);return Math.sqrt(r)},countNonZero:function(t,o){var i=t.data,e=o.height,r=o.width,n=o.x+o.y*t.width,s=t.width-r,a=0,d=void 0,h=void 0;for(d=0;d<e;++d){for(h=0;h<r;++h)0!==i[n++]&&++a;n+=s}return a},binaryBorder:function(t,o){var i=t.data,e=t.height,r=t.width,n=0,s=0,a=void 0,d=void 0;for(d=-2;d<r;++d)o[s++]=0;for(a=0;a<e;++a){for(o[s++]=0,d=0;d<r;++d)o[s++]=0===i[n++]?0:1;o[s++]=0}for(d=-2;d<r;++d)o[s++]=0;return o}},h=d,c={Marker:function(t,o){this.id=t,this.corners=o},Detector:function(){this.grey=new h.Image,this.thres=new h.Image,this.homography=new h.Image,this.binary=[],this.contours=[],this.polys=[],this.candidates=[]}};c.Detector.prototype.detect=function(t){return h.grayscale(t,this.grey),h.adaptiveThreshold(this.grey,this.thres,2,7),this.contours=h.findContours(this.thres,this.binary),this.candidates=this.findCandidates(this.contours,.2*t.width,.05,10),this.candidates=this.clockwiseCorners(this.candidates),this.candidates=this.notTooNear(this.candidates,10),this.findMarkers(this.grey,this.candidates,49)},c.Detector.prototype.findCandidates=function(t,o,i,e){var r=[],n=t.length,s=void 0,a=void 0,d=void 0;for(this.polys=[],d=0;d<n;++d)(s=t[d]).length>=o&&(a=h.approxPolyDP(s,s.length*i),this.polys.push(a),4===a.length&&h.isContourConvex(a)&&h.minEdgeLength(a)>=e&&r.push(a));return r},c.Detector.prototype.clockwiseCorners=function(t){var o=t.length,i=void 0,e=void 0,r=void 0,n=void 0,s=void 0;for(s=0;s<o;++s)i=t[s][1].x-t[s][0].x,r=t[s][1].y-t[s][0].y,e=t[s][2].x-t[s][0].x,i*(t[s][2].y-t[s][0].y)-r*e<0&&(n=t[s][1],t[s][1]=t[s][3],t[s][3]=n);return t},c.Detector.prototype.notTooNear=function(t,o){var i=[],e=t.length,r=void 0,n=void 0,s=void 0,a=void 0,d=void 0,c=void 0;for(a=0;a<e;++a)for(d=a+1;d<e;++d){for(r=0,c=0;c<4;++c)r+=(n=t[a][c].x-t[d][c].x)*n+(s=t[a][c].y-t[d][c].y)*s;r/4<o*o&&(h.perimeter(t[a])<h.perimeter(t[d])?t[a].tooNear=!0:t[d].tooNear=!0)}for(a=0;a<e;++a)t[a].tooNear||i.push(t[a]);return i},c.Detector.prototype.findMarkers=function(t,o,i){var e=[],r=o.length,n=void 0,s=void 0,a=void 0;for(a=0;a<r;++a)n=o[a],h.warp(t,this.homography,n,i),h.threshold(this.homography,this.homography,h.otsu(this.homography)),(s=this.getMarker(this.homography,n))&&e.push(s);return e},c.Detector.prototype.getMarker=function(t,o){var i=t.width/7>>>0,e=i*i>>1,r=[],n=[],s=[],a=void 0,d=void 0,f=void 0,v=void 0,u=void 0;for(v=0;v<7;++v)for(f=0===v||6===v?1:6,u=0;u<7;u+=f)if(a={x:u*i,y:v*i,width:i,height:i},h.countNonZero(t,a)>e)return null;for(v=0;v<5;++v)for(r[v]=[],u=0;u<5;++u)a={x:(u+1)*i,y:(v+1)*i,width:i,height:i},r[v][u]=h.countNonZero(t,a)>e?1:0;for(n[0]=r,s[0]=this.hammingDistance(n[0]),d={first:s[0],second:0},v=1;v<4;++v)n[v]=this.rotate(n[v-1]),s[v]=this.hammingDistance(n[v]),s[v]<d.first&&(d.first=s[v],d.second=v);return 0!==d.first?null:new c.Marker(this.mat2id(n[d.second]),this.rotate2(o,4-d.second))},c.Detector.prototype.hammingDistance=function(t){var o=[[1,0,0,0,0],[1,0,1,1,1],[0,1,0,0,1],[0,1,1,1,0]],i=0,e=void 0,r=void 0,n=void 0,s=void 0,a=void 0;for(n=0;n<5;++n){for(r=1/0,s=0;s<4;++s){for(e=0,a=0;a<5;++a)e+=t[n][a]===o[s][a]?0:1;e<r&&(r=e)}i+=r}return i},c.Detector.prototype.mat2id=function(t){var o=0,i=void 0;for(i=0;i<5;++i)o<<=1,o|=t[i][1],o<<=1,o|=t[i][3];return o},c.Detector.prototype.rotate=function(t){var o=[],i=t.length,e=void 0,r=void 0;for(e=0;e<i;++e)for(o[e]=[],r=0;r<t[e].length;++r)o[e][r]=t[t[e].length-r-1][e];return o},c.Detector.prototype.rotate2=function(t,o){var i=[],e=t.length,r=void 0;for(r=0;r<e;++r)i[r]=t[(o+r)%e];return i};var f=c,v={svdcmp:function(t,o,i,e,r){var n=void 0,s=void 0,a=void 0,d=void 0,h=void 0,c=void 0,f=void 0,u=void 0,l=0,x=void 0,g=void 0,p=0,y=void 0,b=void 0,m=0,w=void 0,M=void 0,_=void 0,j=[];for(s=0;s<i;++s){if(f=s+1,j[s]=m*p,p=b=m=0,s<o){for(c=s;c<o;++c)m+=Math.abs(t[c][s]);if(0!==m){for(c=s;c<o;++c)t[c][s]/=m,b+=t[c][s]*t[c][s];for(y=(g=t[s][s])*(p=-v.sign(Math.sqrt(b),g))-b,t[s][s]=g-p,d=f;d<i;++d){for(b=0,c=s;c<o;++c)b+=t[c][s]*t[c][d];for(g=b/y,c=s;c<o;++c)t[c][d]+=g*t[c][s]}for(c=s;c<o;++c)t[c][s]*=m}}if(e[s]=m*p,p=b=m=0,s<o&&s!==i-1){for(c=f;c<i;++c)m+=Math.abs(t[s][c]);if(0!==m){for(c=f;c<i;++c)t[s][c]/=m,b+=t[s][c]*t[s][c];for(y=(g=t[s][f])*(p=-v.sign(Math.sqrt(b),g))-b,t[s][f]=g-p,c=f;c<i;++c)j[c]=t[s][c]/y;for(d=f;d<o;++d){for(b=0,c=f;c<i;++c)b+=t[d][c]*t[s][c];for(c=f;c<i;++c)t[d][c]+=b*j[c]}for(c=f;c<i;++c)t[s][c]*=m}}l=Math.max(l,Math.abs(e[s])+Math.abs(j[s]))}for(s=i-1;s>=0;--s){if(s<i-1){if(0!==p){for(d=f;d<i;++d)r[d][s]=t[s][d]/t[s][f]/p;for(d=f;d<i;++d){for(b=0,c=f;c<i;++c)b+=t[s][c]*r[c][d];for(c=f;c<i;++c)r[c][d]+=b*r[c][s]}}for(d=f;d<i;++d)r[s][d]=r[d][s]=0}r[s][s]=1,p=j[s],f=s}for(s=Math.min(i,o)-1;s>=0;--s){for(f=s+1,p=e[s],d=f;d<i;++d)t[s][d]=0;if(0!==p){for(p=1/p,d=f;d<i;++d){for(b=0,c=f;c<o;++c)b+=t[c][s]*t[c][d];for(g=b/t[s][s]*p,c=s;c<o;++c)t[c][d]+=g*t[c][s]}for(d=s;d<o;++d)t[d][s]*=p}else for(d=s;d<o;++d)t[d][s]=0;++t[s][s]}for(c=i-1;c>=0;--c)for(a=1;a<=30;++a){for(n=!0,f=c;f>=0;--f){if(u=f-1,Math.abs(j[f])+l===l){n=!1;break}if(Math.abs(e[u])+l===l)break}if(n)for(x=0,b=1,s=f;s<=c&&(g=b*j[s],Math.abs(g)+l!==l);++s)for(p=e[s],y=v.pythag(g,p),e[s]=y,x=p*(y=1/y),b=-g*y,d=1;d<=o;++d)M=t[d][u],_=t[d][s],t[d][u]=M*x+_*b,t[d][s]=_*x-M*b;if(_=e[c],f===c){if(_<0)for(e[c]=-_,d=0;d<i;++d)r[d][c]=-r[d][c];break}if(30===a)return!1;for(w=e[f],g=(((M=e[u=c-1])-_)*(M+_)+((p=j[u])-(y=j[c]))*(p+y))/(2*y*M),p=v.pythag(g,1),g=((w-_)*(w+_)+y*(M/(g+v.sign(p,g))-y))/w,x=b=1,d=f;d<=u;++d){for(p=j[s=d+1],M=e[s],y=b*p,p*=x,_=v.pythag(g,y),j[d]=_,g=w*(x=g/_)+p*(b=y/_),p=p*x-w*b,y=M*b,M*=x,h=0;h<i;++h)w=r[h][d],_=r[h][s],r[h][d]=w*x+_*b,r[h][s]=_*x-w*b;for(_=v.pythag(g,y),e[d]=_,0!==_&&(x=g*(_=1/_),b=y*_),g=x*p+b*M,w=x*M-b*p,h=0;h<o;++h)M=t[h][d],_=t[h][s],t[h][d]=M*x+_*b,t[h][s]=_*x-M*b}j[f]=0,j[c]=g,e[c]=w}return!0},pythag:function(t,o){var i=Math.abs(t),e=Math.abs(o),r=void 0;return i>e?(r=e/i,i*Math.sqrt(1+r*r)):0===e?0:(r=i/e,e*Math.sqrt(1+r*r))},sign:function(t,o){return o>=0?Math.abs(t):-Math.abs(t)}},u=v,l={Posit:function(t,o){this.objectPoints=this.buildModel(t),this.focalLength=o,this.objectVectors=[],this.objectNormal=[],this.objectMatrix=[[],[],[]],this.init()}};l.Posit.prototype.buildModel=function(t){var o=t/2;return[[-o,o,0],[o,o,0],[o,-o,0],[-o,-o,0]]},l.Posit.prototype.init=function(){var t=this.objectPoints.length,o=[],i=[],e=0,r=2,n=void 0;for(n=0;n<t;++n)this.objectVectors[n]=[this.objectPoints[n][0]-this.objectPoints[0][0],this.objectPoints[n][1]-this.objectPoints[0][1],this.objectPoints[n][2]-this.objectPoints[0][2]],o[n]=[this.objectVectors[n][0],this.objectVectors[n][1],this.objectVectors[n][2]];for(;0===e;)i[0]=this.objectVectors[1][1]*this.objectVectors[r][2]-this.objectVectors[1][2]*this.objectVectors[r][1],i[1]=this.objectVectors[1][2]*this.objectVectors[r][0]-this.objectVectors[1][0]*this.objectVectors[r][2],i[2]=this.objectVectors[1][0]*this.objectVectors[r][1]-this.objectVectors[1][1]*this.objectVectors[r][0],e=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),++r;for(n=0;n<3;++n)this.objectNormal[n]=i[n]/e;l.pseudoInverse(o,t,this.objectMatrix)},l.Posit.prototype.pose=function(t){var o,i,e=[[],[],[]],r=[[],[],[]],n=[],s=[[],[],[]],a=[[],[],[]],d=[],h=[],c=void 0,f=void 0,v=void 0,u=void 0;for(this.pos(t,e,r,n),c=(o=this.isValid(e,n))?this.iterate(t,e,n,s,d):{euclidean:-1,pixels:-1,maximum:-1},f=(i=this.isValid(r,n))?this.iterate(t,r,n,a,h):{euclidean:-1,pixels:-1,maximum:-1},v=0;v<3;++v)for(u=0;u<3;++u)o&&(d[v]-=s[v][u]*this.objectPoints[0][u]),i&&(h[v]-=a[v][u]*this.objectPoints[0][u]);return c.euclidean<f.euclidean?new l.Pose(c.pixels,s,d,f.pixels,a,h):new l.Pose(f.pixels,a,h,c.pixels,s,d)},l.Posit.prototype.pos=function(t,o,i,e){var r,n,s,a,d,h=this.objectPoints.length,c=[],f=[],v=[],u=[],l=[],x=[],g=[],p=[],y=void 0,b=void 0,m=void 0,w=void 0,M=void 0;for(w=0;w<h;++w)c[w]=[t[w].x-t[0].x,t[w].y-t[0].y];for(w=0;w<3;++w)for(f[w]=0,v[w]=0,M=0;M<h;++M)f[w]+=this.objectMatrix[w][M]*c[M][0],v[w]+=this.objectMatrix[w][M]*c[M][1];for(r=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],a=((n=v[0]*v[0]+v[1]*v[1]+v[2]*v[2])-r)*(n-r)+(s=f[0]*v[0]+f[1]*v[1]+f[2]*v[2])*s*4,m=(y=n-r>=0?(n-r+Math.sqrt(a))/2:(n-r-Math.sqrt(a))/2)>=0?0===(b=Math.sqrt(y))?0:-s/b:0===(b=Math.sqrt(-s*s/y))?Math.sqrt(r-n):-s/b,w=0;w<3;++w)u[w]=f[w]+b*this.objectNormal[w],l[w]=v[w]+m*this.objectNormal[w];for(d=Math.sqrt(u[0]*u[0]+u[1]*u[1]+u[2]*u[2]),w=0;w<3;++w)x[w]=u[w]/d,g[w]=l[w]/d;for(p[0]=x[1]*g[2]-x[2]*g[1],p[1]=x[2]*g[0]-x[0]*g[2],p[2]=x[0]*g[1]-x[1]*g[0],w=0;w<3;++w)o[0][w]=x[w],o[1][w]=g[w],o[2][w]=p[w];for(w=0;w<3;++w)u[w]=f[w]-b*this.objectNormal[w],l[w]=v[w]-m*this.objectNormal[w];for(w=0;w<3;++w)x[w]=u[w]/d,g[w]=l[w]/d;for(p[0]=x[1]*g[2]-x[2]*g[1],p[1]=x[2]*g[0]-x[0]*g[2],p[2]=x[0]*g[1]-x[1]*g[0],w=0;w<3;++w)i[0][w]=x[w],i[1][w]=g[w],i[2][w]=p[w];e[0]=t[0].x/d,e[1]=t[0].y/d,e[2]=this.focalLength/d},l.Posit.prototype.isValid=function(t,o){for(var i=this.objectPoints.length,e=1/0,r=0,n=void 0;r<i;++r)(n=o[2]+(t[2][0]*this.objectVectors[r][0]+t[2][1]*this.objectVectors[r][1]+t[2][2]*this.objectVectors[r][2]))<e&&(e=n);return e>=0},l.Posit.prototype.iterate=function(t,o,i,e,r){var n=this.objectPoints.length,s=[],a=[],d=[[],[],[]],h=[[],[],[]],c=[],f=[],v=!1,u=0,l=void 0,x=void 0,g=void 0,p=void 0,y=void 0,b=void 0,m=void 0,w=void 0,M=void 0;for(w=0;w<n;++w)s[w]={x:t[w].x,y:t[w].y};for(w=0;w<3;++w){for(M=0;M<3;++M)e[w][M]=o[w][M];r[w]=i[w]}for(w=0;w<n;++w){for(g=0,M=0;M<3;++M)g+=this.objectVectors[w][M]*e[2][M]/r[2];a[w]={x:(1+g)*t[w].x,y:(1+g)*t[w].y}}for(x=0,w=0;w<n;++w)x+=Math.abs(a[w].x-s[w].x),x+=Math.abs(a[w].y-s[w].y);for(w=0;w<3;++w)c[w]=r[w]-(e[w][0]*this.objectPoints[0][0]+e[w][1]*this.objectPoints[0][1]+e[w][2]*this.objectPoints[0][2]);for(v=0===(y=this.error(t,e,c)).pixels||x<.01;u++<100&&!v;){for(w=0;w<n;++w)s[w].x=a[w].x,s[w].y=a[w].y;for(this.pos(a,d,h,r),w=0;w<3;++w)c[w]=r[w]-(d[w][0]*this.objectPoints[0][0]+d[w][1]*this.objectPoints[0][1]+d[w][2]*this.objectPoints[0][2]),f[w]=r[w]-(h[w][0]*this.objectPoints[0][0]+h[w][1]*this.objectPoints[0][1]+h[w][2]*this.objectPoints[0][2]);if(y=this.error(t,d,c),b=this.error(t,h,f),y.euclidean>=0&&b.euclidean>=0)if(b.euclidean<y.euclidean)for(p=b,w=0;w<3;++w)for(M=0;M<3;++M)e[w][M]=h[w][M];else for(p=y,w=0;w<3;++w)for(M=0;M<3;++M)e[w][M]=d[w][M];if(y.euclidean<0&&b.euclidean>=0)for(p=b,w=0;w<3;++w)for(M=0;M<3;++M)e[w][M]=h[w][M];if(b.euclidean<0&&y.euclidean>=0)for(p=y,w=0;w<3;++w)for(M=0;M<3;++M)e[w][M]=d[w][M];for(w=0;w<n;++w){for(g=0,M=0;M<3;++M)g+=this.objectVectors[w][M]*e[2][M]/r[2];a[w].x=(1+g)*t[w].x,a[w].y=(1+g)*t[w].y}for(l=x,x=0,w=0;w<n;++w)x+=Math.abs(a[w].x-s[w].x),x+=Math.abs(a[w].y-s[w].y);m=Math.abs(x-l),v=0===p.pixels||m<.01}return p},l.Posit.prototype.error=function(t,o,i){var e=this.objectPoints.length,r=[],n=[],s=[],a=0,d=0,h=0,c=void 0,f=void 0,v=void 0;if(!this.isValid(o,i))return{euclidean:-1,pixels:-1,maximum:-1};for(c=0;c<e;++c)for(r[c]=[],f=0;f<3;++f)r[c][f]=i[f];for(c=0;c<e;++c)for(f=0;f<3;++f)for(v=0;v<3;++v)r[c][f]+=o[f][v]*this.objectPoints[c][v];for(c=0;c<e;++c)for(n[c]=[],f=0;f<2;++f)n[c][f]=this.focalLength*r[c][f]/r[c][2];for(c=0;c<e;++c)s[c]=[n[c][0]-t[c].x,n[c][1]-t[c].y];for(c=0;c<e;++c)a+=Math.sqrt(s[c][0]*s[c][0]+s[c][1]*s[c][1]),d+=Math.abs(Math.round(n[c][0])-Math.round(t[c].x))+Math.abs(Math.round(n[c][1])-Math.round(t[c].y)),Math.abs(s[c][0])>h&&(h=Math.abs(s[c][0])),Math.abs(s[c][1])>h&&(h=Math.abs(s[c][1]));return{euclidean:a/e,pixels:d,maximum:h}},l.pseudoInverse=function(t,o,i){var e=[],r=[[],[],[]],n=[[],[],[]],s=0,a=0,d=void 0,h=void 0,c=void 0;for(u.svdcmp(t,o,3,e,r),d=0;d<3;++d)e[d]>s&&(s=e[d]);for(s*=.01,d=0;d<3;++d)e[d]<s&&(e[d]=0);for(h=0;h<3;++h)if(0===e[h])for(++a,c=h;c<2;++c){for(d=0;d<o;++d)t[d][c]=t[d][c+1];for(d=0;d<3;++d)r[d][c]=r[d][c+1]}for(h=0;h<2;++h)0===e[h]&&(e[h]=e[h+1]);for(d=0;d<3;++d)for(h=0;h<3-a;++h)n[d][h]=r[d][h]/e[h];for(d=0;d<3;++d)for(h=0;h<o;++h)for(i[d][h]=0,c=0;c<3-a;++c)i[d][h]+=n[d][c]*t[h][c]},l.Pose=function(t,o,i,e,r,n){this.bestError=t,this.bestRotation=o,this.bestTranslation=i,this.alternativeError=e,this.alternativeRotation=r,this.alternativeTranslation=n};var x=l,g={name:"ArucoMarker",props:{arucoId:{type:Number,required:!0},size:{type:Number,default:200}},computed:{svg:function(){var t=[16,23,9,14],o=void 0,i=void 0,e=void 0,r=[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]];for(e=0;e<5;e++)for(o=t[this.id>>2*(4-e)&3],i=0;i<5;i++)r[i][e]=o>>4-i&1?1:0;var n='<svg viewBox="0 0 7 7" version="1.1" xmlns="http://www.w3.org/2000/svg">\n<rect x="0" y="0" width="7" height="7" fill="black"/>\n';for(i=0;i<5;i++)for(e=0;e<5;e++)1===r[i][e]&&(n+='  <rect x="'+(i+1)+'" y="'+(e+1)+'" width="1" height="1" fill="white" stroke="white" stroke-width="0.01" />');return n+="</svg>",window.btoa(n)}}},p={render:function(){var t=this.$createElement;return(this._self._c||t)("img",{attrs:{width:this.size,height:this.size,src:"data:image/svg+xml;base64,"+this.svg}})},staticRenderFns:[]},y=i("VU/8")(g,p,!1,null,null,null).exports;function b(t,o){var i=this;this.videoEl=t,this.canvas=o,this.ctx=o.getContext("2d"),window.addEventListener("resize",function(){return i.onWindowResize()}),this.onWindowResize()}b.prototype.draw=function(){this.ctx.drawImage(this.videoEl,this.offsetX,this.offsetY,this.videoEl.videoWidth*this.scale,this.videoEl.videoHeight*this.scale)},b.prototype.onWindowResize=function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.scale=Math.min(this.canvas.width/this.videoEl.videoWidth,this.canvas.height/this.videoEl.videoHeight),this.offsetX=(this.canvas.width-this.videoEl.videoWidth*this.scale)/2,this.offsetY=(this.canvas.height-this.videoEl.videoHeight*this.scale)/2},b.prototype.getImageData=function(){return this.ctx.getImageData(this.offsetX,this.offsetY,this.videoEl.videoWidth*this.scale,this.videoEl.videoHeight*this.scale)};var m=b;function w(t){this.canvas=t,this.ctx=t.getContext("2d")}w.prototype.draw=function(t){var o=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t.forEach(function(t){o.ctx.beginPath(),o.ctx.lineWidth=10,o.ctx.moveTo(i+t.corners[0].x,e+t.corners[0].y);for(var r=1;r<4;r++)o.ctx.lineTo(i+t.corners[r].x,e+t.corners[r].y);o.ctx.closePath(),o.ctx.strokeStyle="red",o.ctx.stroke(),o.ctx.font="24px Consolas",o.ctx.fillStyle="red",o.ctx.textAlign="center";var n=function(t){for(var o=0,i=0,e=0,r=0;r<t.length;r++){var n=t[r].x*t[(r+1)%t.length].y-t[(r+1)%t.length].x*t[r].y;e+=n,o+=(t[r].x+t[(r+1)%t.length].x)*n,i+=(t[r].y+t[(r+1)%t.length].y)*n}return{x:o/=6*(e*=.5),y:i/=6*e}}(t.corners);o.ctx.fillText(t.id,i+n.x,e+n.y)})};var M=w,_=new f.Detector,j=void 0,P=void 0,k=void 0,V={name:"App",components:{ArucoMarker:y},data:function(){return{markers:[]}},mounted:function(){var t=this;new a(this.$refs.app).requestWebcamFeed().then(function(o){j=new m(o,t.$refs.canvas),P=new M(t.$refs.canvas),t.draw()}),window.addEventListener("resize",function(){return t.onWindowResize()}),this.onWindowResize()},computed:{ctx:function(){return this.$refs.canvas.getContext("2d")}},methods:{onWindowResize:function(){k=new x.Posit(350,this.$refs.canvas.width)},draw:function(){var t=this;requestAnimationFrame(function(){return t.draw()}),this.ctx.clearRect(0,0,this.$refs.canvas.width,this.$refs.canvas.height),j.draw(),this.markers=_.detect(j.getImageData()),this.markers.forEach(function(t){t.pos=k.pose(t.corners),t.pos&&(t.rotation=[-Math.asin(-t.pos.bestRotation[1][2]),-Math.atan2(t.pos.bestRotation[0][2],t.pos.bestRotation[2][2]),Math.atan2(t.pos.bestRotation[1][0],t.pos.bestRotation[1][1])])}),P.draw(this.markers,j.offsetX,j.offsetY)}}},D={render:function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",{ref:"app",attrs:{id:"app"}},[i("div",{attrs:{id:"canvasLayer"}},[i("canvas",{ref:"canvas"})]),t._v(" "),i("div",{attrs:{id:"infoLayer"}},[i("div",{staticClass:"markers"},[i("h2",[t._v("Detected Markers")]),t._v(" "),t._l(t.markers,function(o,e){return i("div",{key:e,staticClass:"marker"},[i("aruco-marker",{attrs:{arucoId:o.id,size:32}}),t._v(" "),i("div",[t._l(o.corners,function(o,e){return i("ul",{key:e},[i("li",[t._v(t._s(o.x)+" / "+t._s(o.y))])])}),t._v(" "),i("ul",[o.pos?i("li",[t._v("POS: "+t._s(o.pos.bestTranslation))]):t._e(),t._v(" "),o.rotation?i("li",[t._v("ROT: "+t._s(o.rotation))]):t._e()])],2)],1)})],2)])])},staticRenderFns:[]};var E=i("VU/8")(V,D,!1,function(t){i("fcl+"),i("Ltj2")},"data-v-550eba33",null).exports;i("RypA"),e.a.config.productionTip=!1,new e.a({el:"#app",components:{App:E},template:"<App/>"})},"fcl+":function(t,o){}},["NHnr"]);
//# sourceMappingURL=app.29cc406419eb89917f40.js.map