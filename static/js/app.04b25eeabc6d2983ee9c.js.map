{"version":3,"sources":["webpack:///./src/lib/WebcamFeed.js","webpack:///./src/lib/CV.js","webpack:///./src/lib/AR.js","webpack:///./src/lib/SVD.js","webpack:///./src/lib/POS.js","webpack:///src/components/ArucoMarker.vue","webpack:///./src/components/ArucoMarker.vue?d8e3","webpack:///./src/components/ArucoMarker.vue","webpack:///./src/lib/VideoDrawer.js","webpack:///./src/lib/MarkerDrawer.js","webpack:///src/App.vue","webpack:///./src/App.vue?14df","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["WebcamFeed","domEl","facingMode","arguments","length","undefined","this","prototype","requestWebcamFeed","videoElement","document","createElement","autoplay","navigator","mediaDevices","getUserMedia","audio","video","then","stream","console","log","srcObject","error","src","URL","createObjectURL","promise_default","a","resolve","reject","onloadedmetadata","metadata","onLoadedMetaData","catch","err","lib_WebcamFeed","CV","width","height","data","imageSrc","imageDst","dst","len","i","j","threshold","tab","kernelSize","stackBoxBlur","hist","sum","sumB","wB","wF","max","mu","between","color","next","stackStart","heightMinus1","widthMinus1","size","radius","mult","stackBoxBlurMult","shift","stackBoxBlurShift","stack","pos","start","p","x","y","BlurStack","imageMean","kernel","gaussianKernel","gaussianBlurFilter","horizontal","limit","cur","value","k","center","sigma","scale2X","Math","exp","binary","deltas","contours","pix","nbd","outer","hole","binaryBorder","neighborhoodDeltas","push","borderFollowing","point","contour","pos1","pos3","pos4","s","sEnd","neighborhood","concat","epsilon","slice","start_index","end_index","rightSlice","poly","pt","startPt","endPt","dist","maxDist","leEps","dx","dy","pop","abs","warpSize","m","sx1","sx2","dx1","dx2","sy1","dy1","dy2","p1","p2","p3","p4","r","t","u","v","w","getPerspectiveTransform","rq","square2quad","px","py","sq","den","orientation","convex","curPt","prevPt","dxdy0","dydx0","dx0","dy0","sqrt","min","Infinity","d","square","span","nz","posSrc","posDst","lib_CV","AR","id","corners","grey","Image","thres","homography","polys","candidates","Detector","detect","image","grayscale","adaptiveThreshold","findContours","findCandidates","clockwiseCorners","notTooNear","findMarkers","minSize","minLength","approxPolyDP","isContourConvex","minEdgeLength","swap","minDist","perimeter","tooNear","markers","candidate","marker","warp","otsu","getMarker","minZero","bits","rotations","distances","pair","inc","countNonZero","hammingDistance","first","second","rotate","Marker","mat2id","rotate2","ids","minSum","rotation","lib_AR","SVD","n","flag","its","jj","l","nm","anorm","c","f","g","h","scale","z","rv1","sign","pythag","b","at","bt","ct","lib_SVD","POS","modelSize","focalLength","objectPoints","buildModel","objectVectors","objectNormal","objectMatrix","init","Posit","half","np","vectors","row","pseudoInverse","pose","imagePoints","valid1","valid2","posRotation1","posRotation2","posTranslation","rotation1","rotation2","translation1","translation2","error1","error2","isValid","iterate","euclidean","pixels","maximum","Pose","translation","i0i0","j0j0","i0j0","delta","imageVectors","i0","j0","ivec","jvec","row1","row2","row3","q","lambda","zmin","zi","posRotation","oldSopImagePoints","sopImagePoints","converged","iteration","oldImageDifference","imageDifference","factor","move","projection","errorvec","round","wmax","cn","svdcmp","bestError","bestRotation","bestTranslation","alternativeError","alternativeRotation","alternativeTranslation","lib_POS","ArucoMarker","Number","components_ArucoMarker","render","_h","$createElement","_self","_c","attrs","svg","staticRenderFns","src_components_ArucoMarker","__webpack_require__","normalizeComponent","VideoDrawer","videoEl","canvas","_this","ctx","getContext","window","addEventListener","onWindowResize","draw","drawImage","offsetX","offsetY","videoWidth","videoHeight","innerWidth","innerHeight","getImageData","lib_VideoDrawer","MarkerDrawer","forEach","beginPath","lineWidth","moveTo","lineTo","closePath","strokeStyle","stroke","font","fillStyle","textAlign","signedArea","centroid","fillText","lib_MarkerDrawer","detector","videoDrawer","markerDrawer","poser","App","app","_this2","asin","atan2","selectortype_template_index_0_src_App","_vm","ref","_v","staticClass","_l","index","key","arucoId","corner","_s","_e","src_App","App_normalizeComponent","ssrContext","vue_esm","config","productionTip","el","components","template"],"mappings":"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","file":"static/js/app.04b25eeabc6d2983ee9c.js","sourcesContent":["function WebcamFeed (domEl, facingMode = 'environment') {\n  this.facingMode = facingMode\n  this.domEl = domEl\n}\n\nfunction onLoadedMetaData (videoElement) {\n  return new Promise((resolve, reject) => {\n    videoElement.onloadedmetadata = metadata => {\n      resolve(metadata)\n    }\n  })\n}\n\nWebcamFeed.prototype.requestWebcamFeed = function () {\n  const videoElement = document.createElement('video')\n  // this.domEl.appendChild(videoElement)\n  videoElement.autoplay = true\n  return navigator.mediaDevices.getUserMedia({\n    audio: false,\n    video: {\n      facingMode: this.facingMode\n    }\n  }).then(stream => {\n    console.log('Got stream', stream)\n    try {\n      videoElement.srcObject = stream\n    } catch (error) {\n      // Fallback to video.src\n      console.log('<video>.srcOject not supported, falling back to <video>.src')\n      video.src = URL.createObjectURL(stream);\n    }\n    return onLoadedMetaData(videoElement)\n  }).then(metadata => {\n    return videoElement\n  }).catch(err => {\n    console.error('Error getting video stream', err)\n  })\n}\n\nexport default WebcamFeed\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/WebcamFeed.js","let CV = {}\n\nCV.Image = function (width, height, data) {\n  this.width = width || 0\n  this.height = height || 0\n  this.data = data || []\n}\n\nCV.grayscale = function (imageSrc, imageDst) {\n  let src = imageSrc.data\n  let dst = imageDst.data\n  let len = src.length\n  let i = 0\n  let j = 0\n\n  for (; i < len; i += 4) {\n    dst[j++] =\n      (src[i] * 0.299 + src[i + 1] * 0.587 + src[i + 2] * 0.114 + 0.5) & 0xff\n  }\n\n  imageDst.width = imageSrc.width\n  imageDst.height = imageSrc.height\n\n  return imageDst\n}\n\nCV.threshold = function (imageSrc, imageDst, threshold) {\n  let src = imageSrc.data\n  let dst = imageDst.data\n  let len = src.length\n  let tab = []\n  let i\n\n  for (i = 0; i < 256; ++i) {\n    tab[i] = i <= threshold ? 0 : 255\n  }\n\n  for (i = 0; i < len; ++i) {\n    dst[i] = tab[src[i]]\n  }\n\n  imageDst.width = imageSrc.width\n  imageDst.height = imageSrc.height\n\n  return imageDst\n}\n\nCV.adaptiveThreshold = function (imageSrc, imageDst, kernelSize, threshold) {\n  let src = imageSrc.data\n  let dst = imageDst.data\n  let len = src.length\n  let tab = []\n  let i\n\n  CV.stackBoxBlur(imageSrc, imageDst, kernelSize)\n\n  for (i = 0; i < 768; ++i) {\n    tab[i] = (i - 255 <= -threshold) ? 255 : 0\n  }\n\n  for (i = 0; i < len; ++i) {\n    dst[i] = tab[src[i] - dst[i] + 255]\n  }\n\n  imageDst.width = imageSrc.width\n  imageDst.height = imageSrc.height\n\n  return imageDst\n}\n\nCV.otsu = function (imageSrc) {\n  let src = imageSrc.data\n  let len = src.length\n  let hist = []\n  let threshold = 0\n  let sum = 0\n  let sumB = 0\n  let wB = 0\n  let wF = 0\n  let max = 0\n  let mu\n  let between\n  let i\n\n  for (i = 0; i < 256; ++i) {\n    hist[i] = 0\n  }\n\n  for (i = 0; i < len; ++i) {\n    hist[src[i]]++\n  }\n\n  for (i = 0; i < 256; ++i) {\n    sum += hist[i] * i\n  }\n\n  for (i = 0; i < 256; ++i) {\n    wB += hist[i]\n    if (wB !== 0) {\n      wF = len - wB\n      if (wF === 0) {\n        break\n      }\n\n      sumB += hist[i] * i\n\n      mu = (sumB / wB) - ((sum - sumB) / wF)\n\n      between = wB * wF * mu * mu\n\n      if (between > max) {\n        max = between\n        threshold = i\n      }\n    }\n  }\n\n  return threshold\n}\n\nCV.stackBoxBlurMult =\n  [1, 171, 205, 293, 57, 373, 79, 137, 241, 27, 391, 357, 41, 19, 283, 265]\n\nCV.stackBoxBlurShift =\n  [0, 9, 10, 11, 9, 12, 10, 11, 12, 9, 13, 13, 10, 9, 13, 13]\n\nCV.BlurStack = function () {\n  this.color = 0\n  this.next = null\n}\n\nCV.stackBoxBlur = function (imageSrc, imageDst, kernelSize) {\n  let src = imageSrc.data\n  let dst = imageDst.data\n  let height = imageSrc.height\n  let width = imageSrc.width\n  let heightMinus1 = height - 1\n  let widthMinus1 = width - 1\n  let size = kernelSize + kernelSize + 1\n  let radius = kernelSize + 1\n  let mult = CV.stackBoxBlurMult[kernelSize]\n  let shift = CV.stackBoxBlurShift[kernelSize]\n  let stack\n  let stackStart\n  let color\n  let sum\n  let pos\n  let start\n  let p\n  let x\n  let y\n  let i\n\n  stack = stackStart = new CV.BlurStack()\n  for (i = 1; i < size; ++i) {\n    stack = stack.next = new CV.BlurStack()\n  }\n  stack.next = stackStart\n\n  pos = 0\n\n  for (y = 0; y < height; ++y) {\n    start = pos\n\n    color = src[pos]\n    sum = radius * color\n\n    stack = stackStart\n    for (i = 0; i < radius; ++i) {\n      stack.color = color\n      stack = stack.next\n    }\n    for (i = 1; i < radius; ++i) {\n      stack.color = src[pos + i]\n      sum += stack.color\n      stack = stack.next\n    }\n\n    stack = stackStart\n    for (x = 0; x < width; ++x) {\n      dst[pos++] = (sum * mult) >>> shift\n\n      p = x + radius\n      p = start + (p < widthMinus1 ? p : widthMinus1)\n      sum -= stack.color - src[p]\n\n      stack.color = src[p]\n      stack = stack.next\n    }\n  }\n\n  for (x = 0; x < width; ++x) {\n    pos = x\n    start = pos + width\n\n    color = dst[pos]\n    sum = radius * color\n\n    stack = stackStart\n    for (i = 0; i < radius; ++i) {\n      stack.color = color\n      stack = stack.next\n    }\n    for (i = 1; i < radius; ++i) {\n      stack.color = dst[start]\n      sum += stack.color\n      stack = stack.next\n\n      start += width\n    }\n\n    stack = stackStart\n    for (y = 0; y < height; ++y) {\n      dst[pos] = (sum * mult) >>> shift\n\n      p = y + radius\n      p = x + ((p < heightMinus1 ? p : heightMinus1) * width)\n      sum -= stack.color - dst[p]\n\n      stack.color = dst[p]\n      stack = stack.next\n\n      pos += width\n    }\n  }\n\n  return imageDst\n}\n\nCV.gaussianBlur = function (imageSrc, imageDst, imageMean, kernelSize) {\n  let kernel = CV.gaussianKernel(kernelSize)\n\n  imageDst.width = imageSrc.width\n  imageDst.height = imageSrc.height\n\n  imageMean.width = imageSrc.width\n  imageMean.height = imageSrc.height\n\n  CV.gaussianBlurFilter(imageSrc, imageMean, kernel, true)\n  CV.gaussianBlurFilter(imageMean, imageDst, kernel, false)\n\n  return imageDst\n}\n\nCV.gaussianBlurFilter = function (imageSrc, imageDst, kernel, horizontal) {\n  let src = imageSrc.data\n  let dst = imageDst.data\n  let height = imageSrc.height\n  let width = imageSrc.width\n  let pos = 0\n  let limit = kernel.length >> 1\n  let cur\n  let value\n  let i\n  let j\n  let k\n\n  for (i = 0; i < height; ++i) {\n    for (j = 0; j < width; ++j) {\n      value = 0.0\n\n      for (k = -limit; k <= limit; ++k) {\n        if (horizontal) {\n          cur = pos + k\n          if (j + k < 0) {\n            cur = pos\n          } else if (j + k >= width) {\n            cur = pos\n          }\n        } else {\n          cur = pos + (k * width)\n          if (i + k < 0) {\n            cur = pos\n          } else if (i + k >= height) {\n            cur = pos\n          }\n        }\n\n        value += kernel[limit + k] * src[cur]\n      }\n\n      dst[pos++] = horizontal ? value : (value + 0.5) & 0xff\n    }\n  }\n\n  return imageDst\n}\n\nCV.gaussianKernel = function (kernelSize) {\n  let tab = [[1], [0.25, 0.5, 0.25], [0.0625, 0.25, 0.375, 0.25, 0.0625], [0.03125, 0.109375, 0.21875, 0.28125, 0.21875, 0.109375, 0.03125]]\n  let kernel = []\n  let center\n  let sigma\n  let scale2X\n  let sum\n  let x\n  let i\n\n  if ((kernelSize <= 7) && (kernelSize % 2 === 1)) {\n    kernel = tab[kernelSize >> 1]\n  } else {\n    center = (kernelSize - 1.0) * 0.5\n    sigma = 0.8 + (0.3 * (center - 1.0))\n    scale2X = -0.5 / (sigma * sigma)\n    sum = 0.0\n    for (i = 0; i < kernelSize; ++i) {\n      x = i - center\n      sum += kernel[i] = Math.exp(scale2X * x * x)\n    }\n    sum = 1 / sum\n    for (i = 0; i < kernelSize; ++i) {\n      kernel[i] *= sum\n    }\n  }\n\n  return kernel\n}\n\nCV.findContours = function (imageSrc, binary) {\n  let width = imageSrc.width\n  let height = imageSrc.height\n  let contours = []\n  let src\n  let deltas\n  let pos\n  let pix\n  let nbd\n  let outer\n  let hole\n  let i\n  let j\n\n  src = CV.binaryBorder(imageSrc, binary)\n\n  deltas = CV.neighborhoodDeltas(width + 2)\n\n  pos = width + 3\n  nbd = 1\n\n  for (i = 0; i < height; ++i, pos += 2) {\n    for (j = 0; j < width; ++j, ++pos) {\n      pix = src[pos]\n\n      if (pix !== 0) {\n        outer = hole = false\n\n        if (pix === 1 && src[pos - 1] === 0) {\n          outer = true\n        } else if (pix >= 1 && src[pos + 1] === 0) {\n          hole = true\n        }\n\n        if (outer || hole) {\n          ++nbd\n\n          contours.push(CV.borderFollowing(src, pos, nbd, { x: j, y: i }, hole, deltas))\n        }\n      }\n    }\n  }\n\n  return contours\n}\n\nCV.borderFollowing = function (src, pos, nbd, point, hole, deltas) {\n  let contour = []\n  let pos1\n  let pos3\n  let pos4\n  let s\n  let sEnd\n  // let sPrev\n\n  contour.hole = hole\n\n  s = sEnd = hole ? 0 : 4\n  do {\n    s = (s - 1) & 7\n    pos1 = pos + deltas[s]\n    if (src[pos1] !== 0) {\n      break\n    }\n  } while (s !== sEnd)\n\n  if (s === sEnd) {\n    src[pos] = -nbd\n    contour.push({ x: point.x, y: point.y })\n  } else {\n    pos3 = pos\n    // sPrev = s ^ 4\n\n    while (true) {\n      sEnd = s\n\n      do {\n        pos4 = pos3 + deltas[++s]\n      } while (src[pos4] === 0)\n\n      s &= 7\n\n      if (((s - 1) >>> 0) < (sEnd >>> 0)) {\n        src[pos3] = -nbd\n      } else if (src[pos3] === 1) {\n        src[pos3] = nbd\n      }\n\n      contour.push({ x: point.x, y: point.y })\n\n      // sPrev = s\n\n      point.x += CV.neighborhood[s][0]\n      point.y += CV.neighborhood[s][1]\n\n      if ((pos4 === pos) && (pos3 === pos1)) {\n        break\n      }\n\n      pos3 = pos4\n      s = (s + 4) & 7\n    }\n  }\n\n  return contour\n}\n\nCV.neighborhood =\n  [[1, 0], [1, -1], [0, -1], [-1, -1], [-1, 0], [-1, 1], [0, 1], [1, 1]]\n\nCV.neighborhoodDeltas = function (width) {\n  let deltas = []\n  let len = CV.neighborhood.length\n  let i = 0\n\n  for (; i < len; ++i) {\n    deltas[i] = CV.neighborhood[i][0] + (CV.neighborhood[i][1] * width)\n  }\n\n  return deltas.concat(deltas)\n}\n\nCV.approxPolyDP = function (contour, epsilon) {\n  let slice = { start_index: 0, end_index: 0 }\n  let rightSlice = { start_index: 0, end_index: 0 }\n  let poly = []\n  let stack = []\n  let len = contour.length\n  let pt\n  let startPt\n  let endPt\n  let dist\n  let maxDist\n  let leEps\n  let dx\n  let dy\n  let i\n  let j\n  let k\n\n  epsilon *= epsilon\n\n  k = 0\n\n  for (i = 0; i < 3; ++i) {\n    maxDist = 0\n\n    k = (k + rightSlice.start_index) % len\n    startPt = contour[k]\n    if (++k === len) { k = 0 }\n\n    for (j = 1; j < len; ++j) {\n      pt = contour[k]\n      if (++k === len) { k = 0 }\n\n      dx = pt.x - startPt.x\n      dy = pt.y - startPt.y\n      dist = dx * dx + dy * dy\n\n      if (dist > maxDist) {\n        maxDist = dist\n        rightSlice.start_index = j\n      }\n    }\n  }\n\n  if (maxDist <= epsilon) {\n    poly.push({ x: startPt.x, y: startPt.y })\n  } else {\n    slice.start_index = k\n    slice.end_index = (rightSlice.start_index += slice.start_index)\n\n    rightSlice.start_index -= rightSlice.start_index >= len ? len : 0\n    rightSlice.end_index = slice.start_index\n    if (rightSlice.end_index < rightSlice.start_index) {\n      rightSlice.end_index += len\n    }\n\n    stack.push({ start_index: rightSlice.start_index, end_index: rightSlice.end_index })\n    stack.push({ start_index: slice.start_index, end_index: slice.end_index })\n  }\n\n  while (stack.length !== 0) {\n    slice = stack.pop()\n\n    endPt = contour[slice.end_index % len]\n    startPt = contour[k = slice.start_index % len]\n    if (++k === len) { k = 0 }\n\n    if (slice.end_index <= slice.start_index + 1) {\n      leEps = true\n    } else {\n      maxDist = 0\n\n      dx = endPt.x - startPt.x\n      dy = endPt.y - startPt.y\n\n      for (i = slice.start_index + 1; i < slice.end_index; ++i) {\n        pt = contour[k]\n        if (++k === len) { k = 0 }\n\n        dist = Math.abs((pt.y - startPt.y) * dx - (pt.x - startPt.x) * dy)\n\n        if (dist > maxDist) {\n          maxDist = dist\n          rightSlice.start_index = i\n        }\n      }\n\n      leEps = maxDist * maxDist <= epsilon * (dx * dx + dy * dy)\n    }\n\n    if (leEps) {\n      poly.push({ x: startPt.x, y: startPt.y })\n    } else {\n      rightSlice.end_index = slice.end_index\n      slice.end_index = rightSlice.start_index\n\n      stack.push({ start_index: rightSlice.start_index, end_index: rightSlice.end_index })\n      stack.push({ start_index: slice.start_index, end_index: slice.end_index })\n    }\n  }\n\n  return poly\n}\n\nCV.warp = function (imageSrc, imageDst, contour, warpSize) {\n  let src = imageSrc.data\n  let dst = imageDst.data\n  let width = imageSrc.width\n  let height = imageSrc.height\n  let pos = 0\n  let sx1\n  let sx2\n  let dx1\n  let dx2\n  let sy1\n  let sy2\n  let dy1\n  let dy2\n  let p1\n  let p2\n  let p3\n  let p4\n  let m\n  let r\n  let s\n  let t\n  let u\n  let v\n  let w\n  let x\n  let y\n  let i\n  let j\n\n  m = CV.getPerspectiveTransform(contour, warpSize - 1)\n\n  r = m[8]\n  s = m[2]\n  t = m[5]\n\n  for (i = 0; i < warpSize; ++i) {\n    r += m[7]\n    s += m[1]\n    t += m[4]\n\n    u = r\n    v = s\n    w = t\n\n    for (j = 0; j < warpSize; ++j) {\n      u += m[6]\n      v += m[0]\n      w += m[3]\n\n      x = v / u\n      y = w / u\n\n      sx1 = x >>> 0\n      sx2 = (sx1 === width - 1) ? sx1 : sx1 + 1\n      dx1 = x - sx1\n      dx2 = 1.0 - dx1\n\n      sy1 = y >>> 0\n      sy2 = (sy1 === height - 1) ? sy1 : sy1 + 1\n      dy1 = y - sy1\n      dy2 = 1.0 - dy1\n\n      p1 = p2 = sy1 * width\n      p3 = p4 = sy2 * width\n\n      dst[pos++] =\n        (dy2 * (dx2 * src[p1 + sx1] + dx1 * src[p2 + sx2]) +\n          dy1 * (dx2 * src[p3 + sx1] + dx1 * src[p4 + sx2])) & 0xff\n    }\n  }\n\n  imageDst.width = warpSize\n  imageDst.height = warpSize\n\n  return imageDst\n}\n\nCV.getPerspectiveTransform = function (src, size) {\n  let rq = CV.square2quad(src)\n\n  rq[0] /= size\n  rq[1] /= size\n  rq[3] /= size\n  rq[4] /= size\n  rq[6] /= size\n  rq[7] /= size\n\n  return rq\n}\n\nCV.square2quad = function (src) {\n  let sq = []\n  let px\n  let py\n  let dx1\n  let dx2\n  let dy1\n  let dy2\n  let den\n\n  px = src[0].x - src[1].x + src[2].x - src[3].x\n  py = src[0].y - src[1].y + src[2].y - src[3].y\n\n  if (px === 0 && py === 0) {\n    sq[0] = src[1].x - src[0].x\n    sq[1] = src[2].x - src[1].x\n    sq[2] = src[0].x\n    sq[3] = src[1].y - src[0].y\n    sq[4] = src[2].y - src[1].y\n    sq[5] = src[0].y\n    sq[6] = 0\n    sq[7] = 0\n    sq[8] = 1\n  } else {\n    dx1 = src[1].x - src[2].x\n    dx2 = src[3].x - src[2].x\n    dy1 = src[1].y - src[2].y\n    dy2 = src[3].y - src[2].y\n    den = dx1 * dy2 - dx2 * dy1\n\n    sq[6] = (px * dy2 - dx2 * py) / den\n    sq[7] = (dx1 * py - px * dy1) / den\n    sq[8] = 1\n    sq[0] = src[1].x - src[0].x + sq[6] * src[1].x\n    sq[1] = src[3].x - src[0].x + sq[7] * src[3].x\n    sq[2] = src[0].x\n    sq[3] = src[1].y - src[0].y + sq[6] * src[1].y\n    sq[4] = src[3].y - src[0].y + sq[7] * src[3].y\n    sq[5] = src[0].y\n  }\n\n  return sq\n}\n\nCV.isContourConvex = function (contour) {\n  let orientation = 0\n  let convex = true\n  let len = contour.length\n  let i = 0\n  let j = 0\n  let curPt\n  let prevPt\n  let dxdy0\n  let dydx0\n  let dx0\n  let dy0\n  let dx\n  let dy\n\n  prevPt = contour[len - 1]\n  curPt = contour[0]\n\n  dx0 = curPt.x - prevPt.x\n  dy0 = curPt.y - prevPt.y\n\n  for (; i < len; ++i) {\n    if (++j === len) { j = 0 }\n\n    prevPt = curPt\n    curPt = contour[j]\n\n    dx = curPt.x - prevPt.x\n    dy = curPt.y - prevPt.y\n    dxdy0 = dx * dy0\n    dydx0 = dy * dx0\n\n    orientation |= dydx0 > dxdy0 ? 1 : (dydx0 < dxdy0 ? 2 : 3)\n\n    if (orientation === 3) {\n      convex = false\n      break\n    }\n\n    dx0 = dx\n    dy0 = dy\n  }\n\n  return convex\n}\n\nCV.perimeter = function (poly) {\n  let len = poly.length\n  let i = 0\n  let j = len - 1\n  let p = 0.0\n  let dx\n  let dy\n\n  for (; i < len; j = i++) {\n    dx = poly[i].x - poly[j].x\n    dy = poly[i].y - poly[j].y\n\n    p += Math.sqrt(dx * dx + dy * dy)\n  }\n\n  return p\n}\n\nCV.minEdgeLength = function (poly) {\n  let len = poly.length\n  let i = 0\n  let j = len - 1\n  let min = Infinity\n  let d\n  let dx\n  let dy\n\n  for (; i < len; j = i++) {\n    dx = poly[i].x - poly[j].x\n    dy = poly[i].y - poly[j].y\n\n    d = dx * dx + dy * dy\n\n    if (d < min) {\n      min = d\n    }\n  }\n\n  return Math.sqrt(min)\n}\n\nCV.countNonZero = function (imageSrc, square) {\n  let src = imageSrc.data\n  let height = square.height\n  let width = square.width\n  let pos = square.x + (square.y * imageSrc.width)\n  let span = imageSrc.width - width\n  let nz = 0\n  let i\n  let j\n\n  for (i = 0; i < height; ++i) {\n    for (j = 0; j < width; ++j) {\n      if (src[pos++] !== 0) {\n        ++nz\n      }\n    }\n\n    pos += span\n  }\n\n  return nz\n}\n\nCV.binaryBorder = function (imageSrc, dst) {\n  let src = imageSrc.data\n  let height = imageSrc.height\n  let width = imageSrc.width\n  let posSrc = 0\n  let posDst = 0\n  let i\n  let j\n\n  for (j = -2; j < width; ++j) {\n    dst[posDst++] = 0\n  }\n\n  for (i = 0; i < height; ++i) {\n    dst[posDst++] = 0\n\n    for (j = 0; j < width; ++j) {\n      dst[posDst++] = (src[posSrc++] === 0 ? 0 : 1)\n    }\n\n    dst[posDst++] = 0\n  }\n\n  for (j = -2; j < width; ++j) {\n    dst[posDst++] = 0\n  }\n\n  return dst\n}\n\nexport default CV\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/CV.js","\nimport CV from './CV'\n\nlet AR = {}\n\nAR.Marker = function (id, corners) {\n  this.id = id\n  this.corners = corners\n}\n\nAR.Detector = function () {\n  this.grey = new CV.Image()\n  this.thres = new CV.Image()\n  this.homography = new CV.Image()\n  this.binary = []\n  this.contours = []\n  this.polys = []\n  this.candidates = []\n}\n\nAR.Detector.prototype.detect = function (image) {\n  CV.grayscale(image, this.grey)\n  CV.adaptiveThreshold(this.grey, this.thres, 2, 7)\n\n  this.contours = CV.findContours(this.thres, this.binary)\n\n  this.candidates = this.findCandidates(this.contours, image.width * 0.20, 0.05, 10)\n  this.candidates = this.clockwiseCorners(this.candidates)\n  this.candidates = this.notTooNear(this.candidates, 10)\n\n  return this.findMarkers(this.grey, this.candidates, 49)\n}\n\nAR.Detector.prototype.findCandidates = function (contours, minSize, epsilon, minLength) {\n  let candidates = []\n  let len = contours.length\n  let contour\n  let poly\n  let i\n\n  this.polys = []\n\n  for (i = 0; i < len; ++i) {\n    contour = contours[i]\n\n    if (contour.length >= minSize) {\n      poly = CV.approxPolyDP(contour, contour.length * epsilon)\n\n      this.polys.push(poly)\n\n      if ((poly.length === 4) && (CV.isContourConvex(poly))) {\n        if (CV.minEdgeLength(poly) >= minLength) {\n          candidates.push(poly)\n        }\n      }\n    }\n  }\n\n  return candidates\n}\n\nAR.Detector.prototype.clockwiseCorners = function (candidates) {\n  let len = candidates.length\n  let dx1\n  let dx2\n  let dy1\n  let dy2\n  let swap\n  let i\n\n  for (i = 0; i < len; ++i) {\n    dx1 = candidates[i][1].x - candidates[i][0].x\n    dy1 = candidates[i][1].y - candidates[i][0].y\n    dx2 = candidates[i][2].x - candidates[i][0].x\n    dy2 = candidates[i][2].y - candidates[i][0].y\n\n    if ((dx1 * dy2 - dy1 * dx2) < 0) {\n      swap = candidates[i][1]\n      candidates[i][1] = candidates[i][3]\n      candidates[i][3] = swap\n    }\n  }\n\n  return candidates\n}\n\nAR.Detector.prototype.notTooNear = function (candidates, minDist) {\n  let notTooNear = []\n  let len = candidates.length\n  let dist\n  let dx\n  let dy\n  let i\n  let j\n  let k\n\n  for (i = 0; i < len; ++i) {\n    for (j = i + 1; j < len; ++j) {\n      dist = 0\n\n      for (k = 0; k < 4; ++k) {\n        dx = candidates[i][k].x - candidates[j][k].x\n        dy = candidates[i][k].y - candidates[j][k].y\n\n        dist += dx * dx + dy * dy\n      }\n\n      if ((dist / 4) < (minDist * minDist)) {\n        if (CV.perimeter(candidates[i]) < CV.perimeter(candidates[j])) {\n          candidates[i].tooNear = true\n        } else {\n          candidates[j].tooNear = true\n        }\n      }\n    }\n  }\n\n  for (i = 0; i < len; ++i) {\n    if (!candidates[i].tooNear) {\n      notTooNear.push(candidates[i])\n    }\n  }\n\n  return notTooNear\n}\n\nAR.Detector.prototype.findMarkers = function (imageSrc, candidates, warpSize) {\n  let markers = []\n  let len = candidates.length\n  let candidate\n  let marker\n  let i\n\n  for (i = 0; i < len; ++i) {\n    candidate = candidates[i]\n\n    CV.warp(imageSrc, this.homography, candidate, warpSize)\n\n    CV.threshold(this.homography, this.homography, CV.otsu(this.homography))\n\n    marker = this.getMarker(this.homography, candidate)\n    if (marker) {\n      markers.push(marker)\n    }\n  }\n\n  return markers\n}\n\nAR.Detector.prototype.getMarker = function (imageSrc, candidate) {\n  let width = (imageSrc.width / 7) >>> 0\n  let minZero = (width * width) >> 1\n  let bits = []\n  let rotations = []\n  let distances = []\n  let square\n  let pair\n  let inc\n  let i\n  let j\n\n  for (i = 0; i < 7; ++i) {\n    inc = (i === 0 || i === 6) ? 1 : 6\n\n    for (j = 0; j < 7; j += inc) {\n      square = { x: j * width, y: i * width, width: width, height: width }\n      if (CV.countNonZero(imageSrc, square) > minZero) {\n        return null\n      }\n    }\n  }\n\n  for (i = 0; i < 5; ++i) {\n    bits[i] = []\n\n    for (j = 0; j < 5; ++j) {\n      square = { x: (j + 1) * width, y: (i + 1) * width, width: width, height: width }\n\n      bits[i][j] = CV.countNonZero(imageSrc, square) > minZero ? 1 : 0\n    }\n  }\n\n  rotations[0] = bits\n  distances[0] = this.hammingDistance(rotations[0])\n\n  pair = { first: distances[0], second: 0 }\n\n  for (i = 1; i < 4; ++i) {\n    rotations[i] = this.rotate(rotations[i - 1])\n    distances[i] = this.hammingDistance(rotations[i])\n\n    if (distances[i] < pair.first) {\n      pair.first = distances[i]\n      pair.second = i\n    }\n  }\n\n  if (pair.first !== 0) {\n    return null\n  }\n\n  return new AR.Marker(\n    this.mat2id(rotations[pair.second]),\n    this.rotate2(candidate, 4 - pair.second))\n}\n\nAR.Detector.prototype.hammingDistance = function (bits) {\n  let ids = [[1, 0, 0, 0, 0], [1, 0, 1, 1, 1], [0, 1, 0, 0, 1], [0, 1, 1, 1, 0]]\n  let dist = 0\n  let sum\n  let minSum\n  let i\n  let j\n  let k\n\n  for (i = 0; i < 5; ++i) {\n    minSum = Infinity\n\n    for (j = 0; j < 4; ++j) {\n      sum = 0\n\n      for (k = 0; k < 5; ++k) {\n        sum += bits[i][k] === ids[j][k] ? 0 : 1\n      }\n\n      if (sum < minSum) {\n        minSum = sum\n      }\n    }\n\n    dist += minSum\n  }\n\n  return dist\n}\n\nAR.Detector.prototype.mat2id = function (bits) {\n  let id = 0\n  let i\n\n  for (i = 0; i < 5; ++i) {\n    id <<= 1\n    id |= bits[i][1]\n    id <<= 1\n    id |= bits[i][3]\n  }\n\n  return id\n}\n\nAR.Detector.prototype.rotate = function (src) {\n  let dst = []\n  let len = src.length\n  let i\n  let j\n\n  for (i = 0; i < len; ++i) {\n    dst[i] = []\n    for (j = 0; j < src[i].length; ++j) {\n      dst[i][j] = src[src[i].length - j - 1][i]\n    }\n  }\n\n  return dst\n}\n\nAR.Detector.prototype.rotate2 = function (src, rotation) {\n  let dst = []\n  let len = src.length\n  let i\n\n  for (i = 0; i < len; ++i) {\n    dst[i] = src[(rotation + i) % len]\n  }\n\n  return dst\n}\n\nexport default AR\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/AR.js","const SVD = {}\n\nSVD.svdcmp = function (a, m, n, w, v) {\n  let flag\n  let i\n  let its\n  let j\n  let jj\n  let k\n  let l\n  let nm\n  let anorm = 0.0\n  let c\n  let f\n  let g = 0.0\n  let h\n  let s\n  let scale = 0.0\n  let x\n  let y\n  let z\n  let rv1 = []\n\n  // Householder reduction to bidiagonal form\n  for (i = 0; i < n; ++i) {\n    l = i + 1\n    rv1[i] = scale * g\n    g = s = scale = 0.0\n    if (i < m) {\n      for (k = i; k < m; ++k) {\n        scale += Math.abs(a[k][i])\n      }\n      if (scale !== 0.0) {\n        for (k = i; k < m; ++k) {\n          a[k][i] /= scale\n          s += a[k][i] * a[k][i]\n        }\n        f = a[i][i]\n        g = -SVD.sign(Math.sqrt(s), f)\n        h = f * g - s\n        a[i][i] = f - g\n        for (j = l; j < n; ++j) {\n          for (s = 0.0, k = i; k < m; ++k) {\n            s += a[k][i] * a[k][j]\n          }\n          f = s / h\n          for (k = i; k < m; ++k) {\n            a[k][j] += f * a[k][i]\n          }\n        }\n        for (k = i; k < m; ++k) {\n          a[k][i] *= scale\n        }\n      }\n    }\n    w[i] = scale * g\n    g = s = scale = 0.0\n    if ((i < m) && (i !== n - 1)) {\n      for (k = l; k < n; ++k) {\n        scale += Math.abs(a[i][k])\n      }\n      if (scale !== 0.0) {\n        for (k = l; k < n; ++k) {\n          a[i][k] /= scale\n          s += a[i][k] * a[i][k]\n        }\n        f = a[i][l]\n        g = -SVD.sign(Math.sqrt(s), f)\n        h = f * g - s\n        a[i][l] = f - g\n        for (k = l; k < n; ++k) {\n          rv1[k] = a[i][k] / h\n        }\n        for (j = l; j < m; ++j) {\n          for (s = 0.0, k = l; k < n; ++k) {\n            s += a[j][k] * a[i][k]\n          }\n          for (k = l; k < n; ++k) {\n            a[j][k] += s * rv1[k]\n          }\n        }\n        for (k = l; k < n; ++k) {\n          a[i][k] *= scale\n        }\n      }\n    }\n    anorm = Math.max(anorm, (Math.abs(w[i]) + Math.abs(rv1[i])))\n  }\n\n  // Acumulation of right-hand transformation\n  for (i = n - 1; i >= 0; --i) {\n    if (i < n - 1) {\n      if (g !== 0.0) {\n        for (j = l; j < n; ++j) {\n          v[j][i] = (a[i][j] / a[i][l]) / g\n        }\n        for (j = l; j < n; ++j) {\n          for (s = 0.0, k = l; k < n; ++k) {\n            s += a[i][k] * v[k][j]\n          }\n          for (k = l; k < n; ++k) {\n            v[k][j] += s * v[k][i]\n          }\n        }\n      }\n      for (j = l; j < n; ++j) {\n        v[i][j] = v[j][i] = 0.0\n      }\n    }\n    v[i][i] = 1.0\n    g = rv1[i]\n    l = i\n  }\n\n  // Acumulation of left-hand transformation\n  for (i = Math.min(n, m) - 1; i >= 0; --i) {\n    l = i + 1\n    g = w[i]\n    for (j = l; j < n; ++j) {\n      a[i][j] = 0.0\n    }\n    if (g !== 0.0) {\n      g = 1.0 / g\n      for (j = l; j < n; ++j) {\n        for (s = 0.0, k = l; k < m; ++k) {\n          s += a[k][i] * a[k][j]\n        }\n        f = (s / a[i][i]) * g\n        for (k = i; k < m; ++k) {\n          a[k][j] += f * a[k][i]\n        }\n      }\n      for (j = i; j < m; ++j) {\n        a[j][i] *= g\n      }\n    } else {\n      for (j = i; j < m; ++j) {\n        a[j][i] = 0.0\n      }\n    }\n    ++a[i][i]\n  }\n\n  // Diagonalization of the bidiagonal form\n  for (k = n - 1; k >= 0; --k) {\n    for (its = 1; its <= 30; ++its) {\n      flag = true\n      for (l = k; l >= 0; --l) {\n        nm = l - 1\n        if (Math.abs(rv1[l]) + anorm === anorm) {\n          flag = false\n          break\n        }\n        if (Math.abs(w[nm]) + anorm === anorm) {\n          break\n        }\n      }\n      if (flag) {\n        c = 0.0\n        s = 1.0\n        for (i = l; i <= k; ++i) {\n          f = s * rv1[i]\n          if (Math.abs(f) + anorm === anorm) {\n            break\n          }\n          g = w[i]\n          h = SVD.pythag(f, g)\n          w[i] = h\n          h = 1.0 / h\n          c = g * h\n          s = -f * h\n          for (j = 1; j <= m; ++j) {\n            y = a[j][nm]\n            z = a[j][i]\n            a[j][nm] = y * c + z * s\n            a[j][i] = z * c - y * s\n          }\n        }\n      }\n\n      // Convergence\n      z = w[k]\n      if (l === k) {\n        if (z < 0.0) {\n          w[k] = -z\n          for (j = 0; j < n; ++j) {\n            v[j][k] = -v[j][k]\n          }\n        }\n        break\n      }\n\n      if (its === 30) {\n        return false\n      }\n\n      // Shift from bottom 2-by-2 minor\n      x = w[l]\n      nm = k - 1\n      y = w[nm]\n      g = rv1[nm]\n      h = rv1[k]\n      f = ((y - z) * (y + z) + (g - h) * (g + h)) / (2.0 * h * y)\n      g = SVD.pythag(f, 1.0)\n      f = ((x - z) * (x + z) + h * ((y / (f + SVD.sign(g, f))) - h)) / x\n\n      // Next QR transformation\n      c = s = 1.0\n      for (j = l; j <= nm; ++j) {\n        i = j + 1\n        g = rv1[i]\n        y = w[i]\n        h = s * g\n        g = c * g\n        z = SVD.pythag(f, h)\n        rv1[j] = z\n        c = f / z\n        s = h / z\n        f = x * c + g * s\n        g = g * c - x * s\n        h = y * s\n        y *= c\n        for (jj = 0; jj < n; ++jj) {\n          x = v[jj][j]\n          z = v[jj][i]\n          v[jj][j] = x * c + z * s\n          v[jj][i] = z * c - x * s\n        }\n        z = SVD.pythag(f, h)\n        w[j] = z\n        if (z !== 0.0) {\n          z = 1.0 / z\n          c = f * z\n          s = h * z\n        }\n        f = c * g + s * y\n        x = c * y - s * g\n        for (jj = 0; jj < m; ++jj) {\n          y = a[jj][j]\n          z = a[jj][i]\n          a[jj][j] = y * c + z * s\n          a[jj][i] = z * c - y * s\n        }\n      }\n      rv1[l] = 0.0\n      rv1[k] = f\n      w[k] = x\n    }\n  }\n\n  return true\n}\n\nSVD.pythag = function (a, b) {\n  let at = Math.abs(a)\n  let bt = Math.abs(b)\n  let ct\n\n  if (at > bt) {\n    ct = bt / at\n    return at * Math.sqrt(1.0 + ct * ct)\n  }\n\n  if (bt === 0.0) {\n    return 0.0\n  }\n\n  ct = at / bt\n  return bt * Math.sqrt(1.0 + ct * ct)\n}\n\nSVD.sign = function (a, b) {\n  return b >= 0.0 ? Math.abs(a) : -Math.abs(a)\n}\n\nexport default SVD\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/SVD.js","import SVD from './SVD'\n\nconst POS = {}\n\nPOS.Posit = function (modelSize, focalLength) {\n  this.objectPoints = this.buildModel(modelSize)\n  this.focalLength = focalLength\n\n  this.objectVectors = []\n  this.objectNormal = []\n  this.objectMatrix = [[], [], []]\n\n  this.init()\n}\n\nPOS.Posit.prototype.buildModel = function (modelSize) {\n  let half = modelSize / 2.0\n\n  return [\n    [-half, half, 0.0],\n    [half, half, 0.0],\n    [half, -half, 0.0],\n    [-half, -half, 0.0]]\n}\n\nPOS.Posit.prototype.init = function () {\n  let np = this.objectPoints.length\n  let vectors = []\n  let n = []\n  let len = 0.0\n  let row = 2\n  let i\n\n  for (i = 0; i < np; ++i) {\n    this.objectVectors[i] = [this.objectPoints[i][0] - this.objectPoints[0][0], this.objectPoints[i][1] - this.objectPoints[0][1], this.objectPoints[i][2] - this.objectPoints[0][2]]\n    vectors[i] = [this.objectVectors[i][0], this.objectVectors[i][1], this.objectVectors[i][2]]\n  }\n\n  while (len === 0.0) {\n    n[0] = this.objectVectors[1][1] * this.objectVectors[row][2] -\n      this.objectVectors[1][2] * this.objectVectors[row][1]\n    n[1] = this.objectVectors[1][2] * this.objectVectors[row][0] -\n      this.objectVectors[1][0] * this.objectVectors[row][2]\n    n[2] = this.objectVectors[1][0] * this.objectVectors[row][1] -\n      this.objectVectors[1][1] * this.objectVectors[row][0]\n\n    len = Math.sqrt(n[0] * n[0] + n[1] * n[1] + n[2] * n[2])\n\n    ++row\n  }\n\n  for (i = 0; i < 3; ++i) {\n    this.objectNormal[i] = n[i] / len\n  }\n\n  POS.pseudoInverse(vectors, np, this.objectMatrix)\n}\n\nPOS.Posit.prototype.pose = function (imagePoints) {\n  let posRotation1 = [[], [], []]\n  let posRotation2 = [[], [], []]\n  let posTranslation = []\n  let rotation1 = [[], [], []]\n  let rotation2 = [[], [], []]\n  let translation1 = []\n  let translation2 = []\n  let error1\n  let error2\n  let valid1\n  let valid2\n  let i\n  let j\n\n  this.pos(imagePoints, posRotation1, posRotation2, posTranslation)\n\n  valid1 = this.isValid(posRotation1, posTranslation)\n  if (valid1) {\n    error1 = this.iterate(imagePoints, posRotation1, posTranslation, rotation1, translation1)\n  } else {\n    error1 = { euclidean: -1.0, pixels: -1, maximum: -1.0 }\n  }\n\n  valid2 = this.isValid(posRotation2, posTranslation)\n  if (valid2) {\n    error2 = this.iterate(imagePoints, posRotation2, posTranslation, rotation2, translation2)\n  } else {\n    error2 = { euclidean: -1.0, pixels: -1, maximum: -1.0 }\n  }\n\n  for (i = 0; i < 3; ++i) {\n    for (j = 0; j < 3; ++j) {\n      if (valid1) {\n        translation1[i] -= rotation1[i][j] * this.objectPoints[0][j]\n      }\n      if (valid2) {\n        translation2[i] -= rotation2[i][j] * this.objectPoints[0][j]\n      }\n    }\n  }\n\n  return error1.euclidean < error2.euclidean\n    ? new POS.Pose(error1.pixels, rotation1, translation1, error2.pixels, rotation2, translation2)\n    : new POS.Pose(error2.pixels, rotation2, translation2, error1.pixels, rotation1, translation1)\n}\n\nPOS.Posit.prototype.pos = function (imagePoints, rotation1, rotation2, translation) {\n  let np = this.objectPoints.length\n  let imageVectors = []\n  let i0 = []\n  let j0 = []\n  let ivec = []\n  let jvec = []\n  let row1 = []\n  let row2 = []\n  let row3 = []\n  let i0i0\n  let j0j0\n  let i0j0\n  let delta\n  let q\n  let lambda\n  let mu\n  let scale\n  let i\n  let j\n\n  for (i = 0; i < np; ++i) {\n    imageVectors[i] = [imagePoints[i].x - imagePoints[0].x, imagePoints[i].y - imagePoints[0].y]\n  }\n\n  // i0 and j0\n  for (i = 0; i < 3; ++i) {\n    i0[i] = 0.0\n    j0[i] = 0.0\n    for (j = 0; j < np; ++j) {\n      i0[i] += this.objectMatrix[i][j] * imageVectors[j][0]\n      j0[i] += this.objectMatrix[i][j] * imageVectors[j][1]\n    }\n  }\n\n  i0i0 = i0[0] * i0[0] + i0[1] * i0[1] + i0[2] * i0[2]\n  j0j0 = j0[0] * j0[0] + j0[1] * j0[1] + j0[2] * j0[2]\n  i0j0 = i0[0] * j0[0] + i0[1] * j0[1] + i0[2] * j0[2]\n\n  // Lambda and mu\n  delta = (j0j0 - i0i0) * (j0j0 - i0i0) + 4.0 * (i0j0 * i0j0)\n\n  if (j0j0 - i0i0 >= 0.0) {\n    q = (j0j0 - i0i0 + Math.sqrt(delta)) / 2.0\n  } else {\n    q = (j0j0 - i0i0 - Math.sqrt(delta)) / 2.0\n  }\n\n  if (q >= 0.0) {\n    lambda = Math.sqrt(q)\n    if (lambda === 0.0) {\n      mu = 0.0\n    } else {\n      mu = -i0j0 / lambda\n    }\n  } else {\n    lambda = Math.sqrt(-(i0j0 * i0j0) / q)\n    if (lambda === 0.0) {\n      mu = Math.sqrt(i0i0 - j0j0)\n    } else {\n      mu = -i0j0 / lambda\n    }\n  }\n\n  // First rotation\n  for (i = 0; i < 3; ++i) {\n    ivec[i] = i0[i] + lambda * this.objectNormal[i]\n    jvec[i] = j0[i] + mu * this.objectNormal[i]\n  }\n\n  scale = Math.sqrt(ivec[0] * ivec[0] + ivec[1] * ivec[1] + ivec[2] * ivec[2])\n\n  for (i = 0; i < 3; ++i) {\n    row1[i] = ivec[i] / scale\n    row2[i] = jvec[i] / scale\n  }\n\n  row3[0] = row1[1] * row2[2] - row1[2] * row2[1]\n  row3[1] = row1[2] * row2[0] - row1[0] * row2[2]\n  row3[2] = row1[0] * row2[1] - row1[1] * row2[0]\n\n  for (i = 0; i < 3; ++i) {\n    rotation1[0][i] = row1[i]\n    rotation1[1][i] = row2[i]\n    rotation1[2][i] = row3[i]\n  }\n\n  // Second rotation\n  for (i = 0; i < 3; ++i) {\n    ivec[i] = i0[i] - lambda * this.objectNormal[i]\n    jvec[i] = j0[i] - mu * this.objectNormal[i]\n  }\n\n  for (i = 0; i < 3; ++i) {\n    row1[i] = ivec[i] / scale\n    row2[i] = jvec[i] / scale\n  }\n\n  row3[0] = row1[1] * row2[2] - row1[2] * row2[1]\n  row3[1] = row1[2] * row2[0] - row1[0] * row2[2]\n  row3[2] = row1[0] * row2[1] - row1[1] * row2[0]\n\n  for (i = 0; i < 3; ++i) {\n    rotation2[0][i] = row1[i]\n    rotation2[1][i] = row2[i]\n    rotation2[2][i] = row3[i]\n  }\n\n  // Translation\n  translation[0] = imagePoints[0].x / scale\n  translation[1] = imagePoints[0].y / scale\n  translation[2] = this.focalLength / scale\n}\n\nPOS.Posit.prototype.isValid = function (rotation, translation) {\n  let np = this.objectPoints.length\n  let zmin = Infinity\n  let i = 0\n  let zi\n\n  for (; i < np; ++i) {\n    zi = translation[2] +\n      (rotation[2][0] * this.objectVectors[i][0] +\n        rotation[2][1] * this.objectVectors[i][1] +\n        rotation[2][2] * this.objectVectors[i][2])\n    if (zi < zmin) {\n      zmin = zi\n    }\n  }\n\n  return zmin >= 0.0\n}\n\nPOS.Posit.prototype.iterate = function (imagePoints, posRotation, posTranslation, rotation, translation) {\n  let np = this.objectPoints.length\n  let oldSopImagePoints = []\n  let sopImagePoints = []\n  let rotation1 = [[], [], []]\n  let rotation2 = [[], [], []]\n  let translation1 = []\n  let translation2 = []\n  let converged = false\n  let iteration = 0\n  let oldImageDifference\n  let imageDifference\n  let factor\n  let error\n  let error1\n  let error2\n  let delta\n  let i\n  let j\n\n  for (i = 0; i < np; ++i) {\n    oldSopImagePoints[i] = {\n      x: imagePoints[i].x,\n      y: imagePoints[i].y\n    }\n  }\n\n  for (i = 0; i < 3; ++i) {\n    for (j = 0; j < 3; ++j) {\n      rotation[i][j] = posRotation[i][j]\n    }\n    translation[i] = posTranslation[i]\n  }\n\n  for (i = 0; i < np; ++i) {\n    factor = 0.0\n    for (j = 0; j < 3; ++j) {\n      factor += this.objectVectors[i][j] * rotation[2][j] / translation[2]\n    }\n    sopImagePoints[i] = {\n      x: (1.0 + factor) * imagePoints[i].x,\n      y: (1.0 + factor) * imagePoints[i].y\n    }\n  }\n\n  imageDifference = 0.0\n\n  for (i = 0; i < np; ++i) {\n    imageDifference += Math.abs(sopImagePoints[i].x - oldSopImagePoints[i].x)\n    imageDifference += Math.abs(sopImagePoints[i].y - oldSopImagePoints[i].y)\n  }\n\n  for (i = 0; i < 3; ++i) {\n    translation1[i] = translation[i] -\n      (rotation[i][0] * this.objectPoints[0][0] +\n        rotation[i][1] * this.objectPoints[0][1] +\n        rotation[i][2] * this.objectPoints[0][2])\n  }\n\n  error1 = this.error(imagePoints, rotation, translation1)\n\n  // vConvergence\n  converged = (error1.pixels === 0.0) || (imageDifference < 0.01)\n\n  while (iteration++ < 100 && !converged) {\n    for (i = 0; i < np; ++i) {\n      oldSopImagePoints[i].x = sopImagePoints[i].x\n      oldSopImagePoints[i].y = sopImagePoints[i].y\n    }\n\n    this.pos(sopImagePoints, rotation1, rotation2, translation)\n\n    for (i = 0; i < 3; ++i) {\n      translation1[i] = translation[i] -\n        (rotation1[i][0] * this.objectPoints[0][0] +\n          rotation1[i][1] * this.objectPoints[0][1] +\n          rotation1[i][2] * this.objectPoints[0][2])\n\n      translation2[i] = translation[i] -\n        (rotation2[i][0] * this.objectPoints[0][0] +\n          rotation2[i][1] * this.objectPoints[0][1] +\n          rotation2[i][2] * this.objectPoints[0][2])\n    }\n\n    error1 = this.error(imagePoints, rotation1, translation1)\n    error2 = this.error(imagePoints, rotation2, translation2)\n\n    if ((error1.euclidean >= 0.0) && (error2.euclidean >= 0.0)) {\n      if (error2.euclidean < error1.euclidean) {\n        error = error2\n        for (i = 0; i < 3; ++i) {\n          for (j = 0; j < 3; ++j) {\n            rotation[i][j] = rotation2[i][j]\n          }\n        }\n      } else {\n        error = error1\n        for (i = 0; i < 3; ++i) {\n          for (j = 0; j < 3; ++j) {\n            rotation[i][j] = rotation1[i][j]\n          }\n        }\n      }\n    }\n\n    if ((error1.euclidean < 0.0) && (error2.euclidean >= 0.0)) {\n      error = error2\n      for (i = 0; i < 3; ++i) {\n        for (j = 0; j < 3; ++j) {\n          rotation[i][j] = rotation2[i][j]\n        }\n      }\n    }\n\n    if ((error2.euclidean < 0.0) && (error1.euclidean >= 0.0)) {\n      error = error1\n      for (i = 0; i < 3; ++i) {\n        for (j = 0; j < 3; ++j) {\n          rotation[i][j] = rotation1[i][j]\n        }\n      }\n    }\n\n    for (i = 0; i < np; ++i) {\n      factor = 0.0\n      for (j = 0; j < 3; ++j) {\n        factor += this.objectVectors[i][j] * rotation[2][j] / translation[2]\n      }\n      sopImagePoints[i].x = (1.0 + factor) * imagePoints[i].x\n      sopImagePoints[i].y = (1.0 + factor) * imagePoints[i].y\n    }\n\n    oldImageDifference = imageDifference\n    imageDifference = 0.0\n\n    for (i = 0; i < np; ++i) {\n      imageDifference += Math.abs(sopImagePoints[i].x - oldSopImagePoints[i].x)\n      imageDifference += Math.abs(sopImagePoints[i].y - oldSopImagePoints[i].y)\n    }\n\n    delta = Math.abs(imageDifference - oldImageDifference)\n\n    converged = (error.pixels === 0.0) || (delta < 0.01)\n  }\n\n  return error\n}\n\nPOS.Posit.prototype.error = function (imagePoints, rotation, translation) {\n  let np = this.objectPoints.length\n  let move = []\n  let projection = []\n  let errorvec = []\n  let euclidean = 0.0\n  let pixels = 0.0\n  let maximum = 0.0\n  let i\n  let j\n  let k\n\n  if (!this.isValid(rotation, translation)) {\n    return { euclidean: -1.0, pixels: -1, maximum: -1.0 }\n  }\n\n  for (i = 0; i < np; ++i) {\n    move[i] = []\n    for (j = 0; j < 3; ++j) {\n      move[i][j] = translation[j]\n    }\n  }\n\n  for (i = 0; i < np; ++i) {\n    for (j = 0; j < 3; ++j) {\n      for (k = 0; k < 3; ++k) {\n        move[i][j] += rotation[j][k] * this.objectPoints[i][k]\n      }\n    }\n  }\n\n  for (i = 0; i < np; ++i) {\n    projection[i] = []\n    for (j = 0; j < 2; ++j) {\n      projection[i][j] = this.focalLength * move[i][j] / move[i][2]\n    }\n  }\n\n  for (i = 0; i < np; ++i) {\n    errorvec[i] = [projection[i][0] - imagePoints[i].x, projection[i][1] - imagePoints[i].y]\n  }\n\n  for (i = 0; i < np; ++i) {\n    euclidean += Math.sqrt(errorvec[i][0] * errorvec[i][0] +\n      errorvec[i][1] * errorvec[i][1])\n\n    pixels += Math.abs(Math.round(projection[i][0]) - Math.round(imagePoints[i].x)) +\n      Math.abs(Math.round(projection[i][1]) - Math.round(imagePoints[i].y))\n\n    if (Math.abs(errorvec[i][0]) > maximum) {\n      maximum = Math.abs(errorvec[i][0])\n    }\n    if (Math.abs(errorvec[i][1]) > maximum) {\n      maximum = Math.abs(errorvec[i][1])\n    }\n  }\n\n  return { euclidean: euclidean / np, pixels: pixels, maximum: maximum }\n}\n\nPOS.pseudoInverse = function (a, n, b) {\n  let w = []\n  let v = [[], [], []]\n  let s = [[], [], []]\n  let wmax = 0.0\n  let cn = 0\n  let i\n  let j\n  let k\n\n  SVD.svdcmp(a, n, 3, w, v)\n\n  for (i = 0; i < 3; ++i) {\n    if (w[i] > wmax) {\n      wmax = w[i]\n    }\n  }\n\n  wmax *= 0.01\n\n  for (i = 0; i < 3; ++i) {\n    if (w[i] < wmax) {\n      w[i] = 0.0\n    }\n  }\n\n  for (j = 0; j < 3; ++j) {\n    if (w[j] === 0.0) {\n      ++cn\n      for (k = j; k < 2; ++k) {\n        for (i = 0; i < n; ++i) {\n          a[i][k] = a[i][k + 1]\n        }\n        for (i = 0; i < 3; ++i) {\n          v[i][k] = v[i][k + 1]\n        }\n      }\n    }\n  }\n\n  for (j = 0; j < 2; ++j) {\n    if (w[j] === 0.0) {\n      w[j] = w[j + 1]\n    }\n  }\n\n  for (i = 0; i < 3; ++i) {\n    for (j = 0; j < 3 - cn; ++j) {\n      s[i][j] = v[i][j] / w[j]\n    }\n  }\n\n  for (i = 0; i < 3; ++i) {\n    for (j = 0; j < n; ++j) {\n      b[i][j] = 0.0\n      for (k = 0; k < 3 - cn; ++k) {\n        b[i][j] += s[i][k] * a[j][k]\n      }\n    }\n  }\n}\n\nPOS.Pose = function (error1, rotation1, translation1, error2, rotation2, translation2) {\n  this.bestError = error1\n  this.bestRotation = rotation1\n  this.bestTranslation = translation1\n  this.alternativeError = error2\n  this.alternativeRotation = rotation2\n  this.alternativeTranslation = translation2\n}\n\nexport default POS\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/POS.js","<template>\n  <img :width=\"size\" :height=\"size\" :src=\"'data:image/svg+xml;base64,' + svg\" />\n</template>\n\n<script>\nexport default {\n  name: 'ArucoMarker',\n  props: {\n    arucoId: {\n      type: Number,\n      required: true\n    },\n    size: {\n      type: Number,\n      default: 200\n    }\n  },\n  computed: {\n    svg () {\n      let ids = [16, 23, 9, 14]\n      let index, val, x, y\n      let matrix = [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]\n\n      for (y = 0; y < 5; y++) {\n        index = (this.id >> 2 * (4 - y)) & 3\n        val = ids[index]\n        for (x = 0; x < 5; x++) {\n          if ((val >> (4 - x)) & 1) {\n            matrix[x][y] = 1\n          } else {\n            matrix[x][y] = 0\n          }\n        }\n      }\n\n      let image = '<svg viewBox=\"0 0 7 7\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\\n<rect x=\"0\" y=\"0\" width=\"7\" height=\"7\" fill=\"black\"/>\\n'\n\n      for (x = 0; x < 5; x++) {\n        for (y = 0; y < 5; y++) {\n          if (matrix[x][y] === 1) {\n            image += '  <rect x=\"' + (x + 1) + '\" y=\"' + (y + 1) + '\" width=\"1\" height=\"1\" fill=\"white\" ' +\n              // Slight stroke to get around aliasing issues with adjacent rectangles\n              'stroke=\"white\" stroke-width=\"0.01\" />'\n          }\n        }\n      }\n\n      image += '</svg>'\n\n      return window.btoa(image)\n    }\n  }\n}\n\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/components/ArucoMarker.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('img',{attrs:{\"width\":_vm.size,\"height\":_vm.size,\"src\":'data:image/svg+xml;base64,' + _vm.svg}})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7fd5d679\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/ArucoMarker.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ArucoMarker.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ArucoMarker.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7fd5d679\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./ArucoMarker.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/ArucoMarker.vue\n// module id = null\n// module chunks = ","function VideoDrawer (videoEl, canvas) {\n  this.videoEl = videoEl\n  this.canvas = canvas\n  this.ctx = canvas.getContext('2d')\n  window.addEventListener('resize', () => this.onWindowResize())\n  this.onWindowResize()\n}\n\nVideoDrawer.prototype.draw = function () {\n  this.ctx.drawImage(this.videoEl, this.offsetX, this.offsetY, this.videoEl.videoWidth * this.scale, this.videoEl.videoHeight * this.scale)\n}\n\nVideoDrawer.prototype.onWindowResize = function () {\n  this.canvas.width = window.innerWidth\n  this.canvas.height = window.innerHeight\n  this.scale = Math.min(this.canvas.width / this.videoEl.videoWidth, this.canvas.height / this.videoEl.videoHeight)\n\n  this.offsetX = (this.canvas.width - this.videoEl.videoWidth * this.scale) / 2\n  this.offsetY = (this.canvas.height - this.videoEl.videoHeight * this.scale) / 2\n}\n\nVideoDrawer.prototype.getImageData = function () {\n  return this.ctx.getImageData(this.offsetX, this.offsetY, this.videoEl.videoWidth * this.scale, this.videoEl.videoHeight * this.scale)\n}\n\nexport default VideoDrawer\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/VideoDrawer.js","function MarkerDrawer (canvas) {\n  this.canvas = canvas\n  this.ctx = canvas.getContext('2d')\n}\n\nMarkerDrawer.prototype.draw = function (markers, offsetX = 0, offsetY = 0) {\n  markers.forEach(m => {\n    this.ctx.beginPath()\n    this.ctx.lineWidth = 10\n    this.ctx.moveTo(offsetX + m.corners[0].x, offsetY + m.corners[0].y)\n    for (let i = 1; i < 4; i++) {\n      this.ctx.lineTo(offsetX + m.corners[i].x, offsetY + m.corners[i].y)\n    }\n    this.ctx.closePath()\n    this.ctx.strokeStyle = 'red'\n    this.ctx.stroke()\n    this.ctx.font = '24px Consolas'\n    this.ctx.fillStyle = 'red'\n    this.ctx.textAlign = 'center'\n    let center = centroid(m.corners)\n    this.ctx.fillText(m.id, offsetX + center.x, offsetY + center.y)\n  })\n}\n\n// Calculates center of a polygon\n// https://en.wikipedia.org/wiki/Centroid#Centroid_of_a_polygon\nfunction centroid (corners) {\n  let x = 0.0\n  let y = 0.0\n  let signedArea = 0.0\n\n  for (let i = 0; i < corners.length; i++) {\n    let a = corners[i].x * corners[(i + 1) % corners.length].y - corners[(i + 1) % corners.length].x * corners[i].y\n    signedArea += a\n    x += (corners[i].x + corners[(i + 1) % corners.length].x) * a\n    y += (corners[i].y + corners[(i + 1) % corners.length].y) * a\n  }\n\n  signedArea *= 0.5\n\n  x /= 6.0 * signedArea\n  y /= 6.0 * signedArea\n\n  return { x, y }\n}\n\nexport default MarkerDrawer\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/MarkerDrawer.js","<template>\n  <div id=\"app\" ref=\"app\">\n    <div id=\"canvasLayer\">\n      <canvas ref=\"canvas\"></canvas>\n    </div>\n    <div id=\"infoLayer\">\n      <div class=\"markers\">\n        <h2>Detected Markers</h2>\n        <div class=\"marker\" v-for=\"(marker, index) in markers\" :key=\"index\">\n          <aruco-marker :arucoId=\"marker.id\" :size=\"32\" />\n          <div>\n            <ul v-for=\"(corner, index) in marker.corners\" :key=\"index\">\n              <li>{{corner.x}} / {{corner.y}}</li>\n            </ul>\n            <ul>\n              <li v-if=\"marker.pos\">POS: {{marker.pos.bestTranslation}}</li>\n              <li v-if=\"marker.rotation\">ROT: {{marker.rotation}}</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport WebcamFeed from './lib/WebcamFeed'\nimport AR from './lib/AR'\nimport POS from './lib/POS'\nimport ArucoMarker from './components/ArucoMarker'\nimport VideoDrawer from './lib/VideoDrawer'\nimport MarkerDrawer from './lib/MarkerDrawer'\n\nlet detector = new AR.Detector()\nlet videoDrawer\nlet markerDrawer\nlet poser\n\nexport default {\n  name: 'App',\n  components: {\n    ArucoMarker\n  },\n  data () {\n    return {\n      markers: []\n    }\n  },\n  mounted () {\n    let feed = new WebcamFeed(this.$refs.app)\n    feed.requestWebcamFeed().then(videoEl => {\n      videoDrawer = new VideoDrawer(videoEl, this.$refs.canvas)\n      markerDrawer = new MarkerDrawer(this.$refs.canvas)\n      this.draw()\n    })\n\n    window.addEventListener('resize', () => this.onWindowResize())\n    this.onWindowResize()\n  },\n  computed: {\n    ctx () {\n      return this.$refs.canvas.getContext('2d')\n    }\n  },\n  methods: {\n    onWindowResize () {\n      poser = new POS.Posit(350, this.$refs.canvas.width)\n    },\n    draw () {\n      // requests animation frame depending on browser\n      requestAnimationFrame(() => this.draw())\n      this.ctx.clearRect(0, 0, this.$refs.canvas.width, this.$refs.canvas.height)\n      // Draws video from video feed to canvas\n      videoDrawer.draw()\n\n      this.markers = detector.detect(videoDrawer.getImageData())\n      this.markers.forEach(m => {\n        m.pos = poser.pose(m.corners)\n        if (m.pos) {\n          m.rotation = [\n            -Math.asin(-m.pos.bestRotation[1][2]),\n            -Math.atan2(m.pos.bestRotation[0][2], m.pos.bestRotation[2][2]),\n            Math.atan2(m.pos.bestRotation[1][0], m.pos.bestRotation[1][1])\n          ]\n        }\n      })\n\n      markerDrawer.draw(this.markers, videoDrawer.offsetX, videoDrawer.offsetY)\n    }\n  }\n}\n</script>\n\n<style scoped>\n#app > div {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n\n#infoLayer {\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n}\n\n.markers {\n  flex: 0 0 300px;\n}\n\n.marker {\n  display: flex;\n  flex-direction: row;\n}\n\n.marker ul {\n  margin: 0;\n}\n</style>\n\n<style>\nhtml,\nbody {\n  padding: 0;\n  margin: 0;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"app\",attrs:{\"id\":\"app\"}},[_c('div',{attrs:{\"id\":\"canvasLayer\"}},[_c('canvas',{ref:\"canvas\"})]),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"infoLayer\"}},[_c('div',{staticClass:\"markers\"},[_c('h2',[_vm._v(\"Detected Markers\")]),_vm._v(\" \"),_vm._l((_vm.markers),function(marker,index){return _c('div',{key:index,staticClass:\"marker\"},[_c('aruco-marker',{attrs:{\"arucoId\":marker.id,\"size\":32}}),_vm._v(\" \"),_c('div',[_vm._l((marker.corners),function(corner,index){return _c('ul',{key:index},[_c('li',[_vm._v(_vm._s(corner.x)+\" / \"+_vm._s(corner.y))])])}),_vm._v(\" \"),_c('ul',[(marker.pos)?_c('li',[_vm._v(\"POS: \"+_vm._s(marker.pos.bestTranslation))]):_vm._e(),_vm._v(\" \"),(marker.rotation)?_c('li',[_vm._v(\"ROT: \"+_vm._s(marker.rotation))]):_vm._e()])],2)],1)})],2)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-550eba33\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-550eba33\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-550eba33\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=1!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-550eba33\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-550eba33\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nrequire('webrtc-adapter/out/adapter')\n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}